<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.4. Flux control &#8212; MCAF R6 RC8 documentation (docver 6.0.2)</title>
    <link rel="stylesheet" href="../../_static/microchip.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mcaf_doc.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/svgcrop.js"></script>
    <script type="text/javascript" src="../../_static/preliminary-draft.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js"></script>
    <script type="text/javascript" src="../../_static/rendermath.js"></script>
    
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.4.1. Flux weakening" href="flux_weakening.html" />
    <link rel="prev" title="5.3.3. Angle-tracking Phase-locked Loop (ATPLL)" href="../atpll.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="flux_weakening.html" title="5.4.1. Flux weakening"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../atpll.html" title="5.3.3. Angle-tracking Phase-locked Loop (ATPLL)"
             accesskey="P">previous</a> |</li>
    <li><img class="nav-logo"
             src="../../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../../index.html">MCAF R6 RC8 (docver 6.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">5. Detailed Algorithm Notes</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="flux-control">
<span id="algorithm-flux-control"></span><span id="index-0"></span><h1>5.4. Flux control<a class="headerlink" href="#flux-control" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="flux_weakening.html">5.4.1. Flux weakening</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flux_weakening.html#motivation">5.4.1.1. Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_weakening.html#effect-on-torque-capability">5.4.1.2. Effect on torque capability</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_weakening.html#flux-weakening-algorithms">5.4.1.3. Flux-weakening algorithms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mtpa.html">5.4.2. Maximum Torque Per Ampere (MTPA)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mtpa.html#overview">5.4.2.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtpa.html#flow-chart-and-description">5.4.2.2. Flow chart and description</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtpa.html#implementation-notes">5.4.2.3. Implementation notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flux_weakening_mtpa_integration.html">5.4.3. D-axis current reference generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flux_weakening_mtpa_integration.html#overview">5.4.3.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_weakening_mtpa_integration.html#flow-chart-and-description">5.4.3.2. Flow chart and description</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_weakening_mtpa_integration.html#calculation-of-q-axis-current-limit">5.4.3.3. Calculation of q-axis current limit</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2>5.4.4. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The flux control module in MCAF deals with generation of a suitable reference value for the d-axis stator current in a
<a class="reference internal" href="../../appendix/glossary.html#term-pmsm"><span class="xref std std-term">PMSM</span></a> which is then given as an input to the d-axis current controller. The need for injecting a
current component in the synchronous d axis could arise out of multiple requirements as described below.</p>
<ul class="simple">
<li>In a <a class="reference internal" href="../../appendix/glossary.html#term-pmsm"><span class="xref std std-term">PMSM</span></a>, the stator voltage is required to increase with rotor velocity. The dc-link
voltage of the inverter, however, puts a limitation on the stator voltage. Other important considerations which do not support
increase in the DC link voltage are user safety and motor’s safe operating zone. Many applications require the motor to be
operated at velocity higher than its rated value. In order to achieve this while also limiting the stator voltage, motor’s
airgap flux is weakened by injecting a negative d-axis stator current in the motor. This operation is called as flux-weakening
(FW). Flux-weakening is required for motors with salient as well as non-salient rotors. The FW module in Flux
Control calculates a suitable d-axis current reference for the flux-weakening operation (<span class="math">\(I_{d\_fw}\)</span>) at a particular
velocity and load.</li>
<li>The second requirement for the flux control module stems specifically from the motors with salient-pole rotors. In case of
salient-pole motors, the reluctance torque (arising out of saliency of the motor) can be made to aid the permanent magnet
torque by injecting a negative d-axis current in the motor. This ensures that the motor operates at its maximum efficiency by
generating Maximum Torque Per Ampere (MTPA). The MTPA algorithm calculates a suitable reference for the MTPA operation
(<span class="math">\(I_{d\_mtpa}\)</span>) for a particular operating point.</li>
</ul>
</div>
<div class="section" id="flow-chart-and-details">
<h2>5.4.5. Flow chart and details<a class="headerlink" href="#flow-chart-and-details" title="Permalink to this headline">¶</a></h2>
<p>The flux control module contains implementations of flux-weakening and MTPA. Depending on the requirement,
either algorithm can be enabled or disabled independently. The flux-weakening module calculates
and returns the d-axis current reference <span class="math">\(I_{d\_fw}\)</span>, whereas the MTPA module calculates and
returns the d-axis current reference <span class="math">\(I_{d\_mtpa}\)</span>. When disabled, either of these algorithms
returns a value equal to zero for their respective d-axis current reference. The <span class="math">\(I_{d\_ref}\)</span>
generation module then chooses the appropriate value between <span class="math">\(I_{d\_fw}\)</span> and <span class="math">\(I_{d\_mtpa}\)</span>
and generates the d-axis current reference <span class="math">\(I_{d\_ref}\)</span> as an input to the current controller.
<a class="reference internal" href="#fig-fw-mtpa-integration"><span class="std std-numref">Figure 5.68</span></a> shows a flow chart of the overall flux control calculations.</p>
<div class="figure align-center" id="id1">
<span id="fig-fw-mtpa-integration"></span><a class="reference internal image-reference" href="../../_images/fw_mtpa_integration.png"><img alt="../../_images/fw_mtpa_integration.png" src="../../_images/fw_mtpa_integration.png" style="width: 500px;" /></a>
<div class="caption_wrapper"><p class="caption"><span class="caption-number">Figure 5.68 </span><span class="caption-text">Overview of flux control algorithm</span></p>
</div></div>
<ul class="simple">
<li>Depending on the requirements, the flux control module can be enabled by setting it to Equation-based.
If flux control is disabled by setting it to None, <span class="math">\(I_{d\_ref}\)</span> is made equal to zero. Once enabled,
either or both of the MTPA and FW algorithms can be enabled.</li>
<li>The flux-weakening and MTPA modules calculate <span class="math">\(I_{d\_fw}\)</span> and <span class="math">\(I_{d\_mtpa}\)</span> respectively. In case these modules
are disabled, corresponding calculated value is made equal to zero.</li>
<li>In case the application requires a salient-pole motor to operate beyond rated velocity, both MTPA as well as FW should be
enabled. In this case, depending on the region of operation, a correct selection between the d-axis current references
calculated by either module is made and that reference is given as an input to the d-axis current controller. Refer to
<a class="reference internal" href="flux_weakening_mtpa_integration.html#algorithm-fw-and-mtpa-integration"><span class="std std-ref">D-axis current reference generation</span></a> for more details.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.4. Flux control</a><ul>
<li><a class="reference internal" href="#overview">5.4.4. Overview</a></li>
<li><a class="reference internal" href="#flow-chart-and-details">5.4.5. Flow chart and details</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../atpll.html"
                        title="previous chapter">5.3.3. Angle-tracking Phase-locked Loop (ATPLL)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="flux_weakening.html"
                        title="next chapter">5.4.1. Flux weakening</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="flux_weakening.html" title="5.4.1. Flux weakening"
             >next</a> |</li>
        <li class="right" >
          <a href="../atpll.html" title="5.3.3. Angle-tracking Phase-locked Loop (ATPLL)"
             >previous</a> |</li>
    <li><img class="nav-logo"
             src="../../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../../index.html">MCAF R6 RC8 (docver 6.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="../index.html" >5. Detailed Algorithm Notes</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2020, Microchip Technology, Inc..
    </div>
  </body>
</html>