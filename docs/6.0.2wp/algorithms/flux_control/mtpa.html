<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.4.2. Maximum Torque Per Ampere (MTPA) &#8212; MCAF R6 RC8 documentation (docver 6.0.2)</title>
    <link rel="stylesheet" href="../../_static/microchip.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mcaf_doc.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/svgcrop.js"></script>
    <script type="text/javascript" src="../../_static/preliminary-draft.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js"></script>
    <script type="text/javascript" src="../../_static/rendermath.js"></script>
    
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.4.3. D-axis current reference generation" href="flux_weakening_mtpa_integration.html" />
    <link rel="prev" title="5.4.1.3.1. Equation based flux-weakening" href="fw_types/fw_eq_based.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="flux_weakening_mtpa_integration.html" title="5.4.3. D-axis current reference generation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fw_types/fw_eq_based.html" title="5.4.1.3.1. Equation based flux-weakening"
             accesskey="P">previous</a> |</li>
    <li><img class="nav-logo"
             src="../../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../../index.html">MCAF R6 RC8 (docver 6.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="../index.html" >5. Detailed Algorithm Notes</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">5.4. Flux control</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="maximum-torque-per-ampere-mtpa">
<span id="algorithm-mtpa"></span><span id="index-0"></span><h1>5.4.2. Maximum Torque Per Ampere (MTPA)<a class="headerlink" href="#maximum-torque-per-ampere-mtpa" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>5.4.2.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>For a surface <a class="reference internal" href="../../appendix/glossary.html#term-pmsm"><span class="xref std std-term">PMSM</span></a>, <span class="math">\(I_{d} = 0\)</span>, <span class="math">\(I_{q} &gt; 0\)</span> results in Maximum Torque Per Ampere (MTPA) operation of the motor.
In a <a class="reference internal" href="../../appendix/glossary.html#term-pmsm"><span class="xref std std-term">PMSM</span></a> with salient pole rotor (e.g. Interior <a class="reference internal" href="../../appendix/glossary.html#term-pmsm"><span class="xref std std-term">PMSM</span></a> or IPMSM), the d and q axis inductance values
are different and often <span class="math">\(L_{q} &gt; L_{d}\)</span>. For a salient-pole motor, the torque equation is given by
<a class="reference internal" href="#equation-torque-equation-salient-motor">5.49</a>. The electromagnetic torque produced here is contributed by two terms. The first term is
the permanent magnet torque and the second term is the reluctance torque. The reluctance torque is produced in the motor as a result
of saliency.</p>
<div class="math" id="equation-torque-equation-salient-motor">
<span class="eqno">(5.49)</span>\[    T_{em} = \frac{3}{2} \frac{P}{2} \Psi_{PM}I_{q} + \frac{3}{2} \frac{P}{2} (L_{d}-L_{q}) I_{q} I_{d}\]</div>
<p>Since <span class="math">\(L_{q} &gt; L_{d}\)</span>, the reluctance torque can be made to aid the permanent magnet torque if <span class="math">\(I_{d} &lt; 0\)</span>. With a suitable
negative <span class="math">\(I_{d}\)</span> value, the motor can be operated at the maximum efficiency yielding Maximum Torque Per Ampere (MTPA) in
an IPMSM. The aim of the MTPA algorithm is to calculate such a d-axis current reference (<span class="math">\(I_{d\_mtpa}\)</span>) for a given
operating point of the motor.</p>
</div>
<div class="section" id="flow-chart-and-description">
<h2>5.4.2.2. Flow chart and description<a class="headerlink" href="#flow-chart-and-description" title="Permalink to this headline">¶</a></h2>
<p>The value of <span class="math">\(I_{d}\)</span> at which the motor operates at maximum efficiency thereby yielding MTPA is derived from the
torque equation, and is given by <a class="reference internal" href="#equation-id-mtpa-equation">5.50</a>. Here, <span class="math">\(\Psi_{PM}\)</span> is the back emf constant in volts per
electrical rad/s units and <span class="math">\(L_{1}\)</span> is the differential inductance given by <span class="math">\(L_{1} = \frac{L_d - L_q}{2}\)</span>.
In addition to the motor parameters <span class="math">\(\Psi_{PM}\)</span> and <span class="math">\(L_{1}\)</span>, the d-axis current needed to ensure MTPA
(<span class="math">\(I_{d\_mtpa}\)</span>) is a function of the q-axis current <span class="math">\(I_{q}\)</span>.</p>
<div class="math" id="equation-id-mtpa-equation">
<span class="eqno">(5.50)</span>\[    I_{d\_mtpa} = \frac{-\Psi_{PM} + \sqrt{\Psi_{PM}{}^2 + (4L_1I_q)^2}}{4L_1}\]</div>
<p><a class="reference internal" href="#fig-mtpa-implementation"><span class="std std-numref">Figure 5.65</span></a> shows the flow chart of the MTPA algorithm.</p>
<div class="figure align-center" id="id1">
<span id="fig-mtpa-implementation"></span><a class="reference internal image-reference" href="../../_images/mtpa_implementation.png"><img alt="../../_images/mtpa_implementation.png" src="../../_images/mtpa_implementation.png" style="width: 600px;" /></a>
<div class="caption_wrapper"><p class="caption"><span class="caption-number">Figure 5.65 </span><span class="caption-text">MTPA algorithm flow chart</span></p>
</div></div>
<p><span class="math">\(I_{d\_mtpa}\)</span> value is calculated using <a class="reference internal" href="#equation-id-mtpa-equation">5.50</a>. This calculated value further goes to
<a class="reference internal" href="flux_weakening_mtpa_integration.html#algorithm-fw-and-mtpa-integration"><span class="std std-ref">D-axis current reference generation</span></a> and is used to generate <span class="math">\(I_{d\_ref}\)</span>.</p>
</div>
<div class="section" id="implementation-notes">
<h2>5.4.2.3. Implementation notes<a class="headerlink" href="#implementation-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Low-saliency optimization: In case the motor saliency is low (<span class="math">\(L_d \approx L_q\)</span>), the MTPA calculation is skipped to
reduce CPU usage, and <span class="math">\(I_{d\_mtpa}\)</span> is set to zero. This is done if the saliency ratio <span class="math">\(\xi = \frac{L_q}{L_d}\)</span>
is less than a user-defined saliency threshold.</li>
<li>Square-root calculation: The present MTPA algorithm uses a full machine-precision square-root calculation. To reduce the CPU
instruction cycles, the future versions of MCAF may include alternatives to this.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.4.2. Maximum Torque Per Ampere (MTPA)</a><ul>
<li><a class="reference internal" href="#overview">5.4.2.1. Overview</a></li>
<li><a class="reference internal" href="#flow-chart-and-description">5.4.2.2. Flow chart and description</a></li>
<li><a class="reference internal" href="#implementation-notes">5.4.2.3. Implementation notes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fw_types/fw_eq_based.html"
                        title="previous chapter">5.4.1.3.1. Equation based flux-weakening</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="flux_weakening_mtpa_integration.html"
                        title="next chapter">5.4.3. D-axis current reference generation</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="flux_weakening_mtpa_integration.html" title="5.4.3. D-axis current reference generation"
             >next</a> |</li>
        <li class="right" >
          <a href="fw_types/fw_eq_based.html" title="5.4.1.3.1. Equation based flux-weakening"
             >previous</a> |</li>
    <li><img class="nav-logo"
             src="../../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../../index.html">MCAF R6 RC8 (docver 6.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="../index.html" >5. Detailed Algorithm Notes</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >5.4. Flux control</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2020, Microchip Technology, Inc..
    </div>
  </body>
</html>