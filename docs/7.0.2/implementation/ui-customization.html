<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.3. Parameter customization &#8212; MCAF R7 RC37 documentation (docver 7.0.2)</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/microchip.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mcaf_doc.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/contrib/auto-render.min.js"></script>
    <script src="../_static/rendermath.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js"></script>
    <script src="../_static/svgcrop.js"></script>
    <script src="../_static/mcaf-styling.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.4. Sampling Rate and PWM Frequency Implications" href="sampling-rate.html" />
    <link rel="prev" title="6.2. Code Generation" href="codegen.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="sampling-rate.html" title="6.4. Sampling Rate and PWM Frequency Implications"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="codegen.html" title="6.2. Code Generation"
             accesskey="P">previous</a> |</li>
    <li><img class="nav-logo"
             src="../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../index.html">MCAF R7 RC37 (docver 7.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><span class="section-number">6. </span>General Implementation Issues</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">6.3. </span>Parameter customization</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="parameter-customization">
<span id="impl-customization"></span><h1><span class="section-number">6.3. </span>Parameter customization<a class="headerlink" href="#parameter-customization" title="Permalink to this heading">¶</a></h1>
<p>As of MCAF R4, parameter customization is available through the  Customize page of motorBench<sup>®</sup> Development Suite, which provides
access to various parameters that affect code generation.</p>
<p>This section provides additional guidance for setting these parameters.</p>
<p><strong>Please note:</strong> MCAF has been designed so that the default values
for customizable parameters are applicable to most motors.
In the event that it is unclear what to do, the best course
of action is to use the default value of each parameter.</p>
<section id="summary">
<h2><span class="section-number">6.3.1. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>The following table describes these parameters briefly.
Links to detailed guidance are included.</p>
<table class="docutils align-default" id="id6">
<caption><span class="caption-number">Table 6.1 </span><span class="caption-text">Customizable parameters</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 22%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Section</p></th>
<th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Current measurement</p></td>
<td><p><a class="reference internal" href="#customize-current-measure-method"><span class="std std-ref">Current measurement</span></a></p></td>
<td><p>Selects which method is used to measure motor phase currents</p></td>
</tr>
<tr class="row-odd"><td><p>Single channel</p></td>
<td><p><a class="reference internal" href="#customize-current-measure-single-channel-minimumtime"><span class="std std-ref">Minimum time window</span></a></p></td>
<td><p>Minimum time window required to measure current</p></td>
</tr>
<tr class="row-even"><td><p>Single channel</p></td>
<td><p><a class="reference internal" href="#customize-current-measure-single-channel-sampledelay"><span class="std std-ref">ADC trigger delay</span></a></p></td>
<td><p>Delay between inverter switching state and ADC sampling point</p></td>
</tr>
<tr class="row-odd"><td><p>Estimators</p></td>
<td><p><a class="reference internal" href="#customize-estimator-type"><span class="std std-ref">Primary estimator</span></a></p></td>
<td><p>Selects which estimator is used for commutation and velocity feedback</p></td>
</tr>
<tr class="row-even"><td><p>Estimators</p></td>
<td><p><a class="reference internal" href="#customize-estimator-active"><span class="std std-ref">Active estimators</span></a></p></td>
<td><p>Selects which estimators are active, in addition to
the primary estimator used for commutation</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-min-velocity-ratio"><span class="std std-ref">Minimum velocity</span></a></p></td>
<td><p>Determines minimum operating velocity</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-startup-velocity-ratio"><span class="std std-ref">Startup velocity</span></a></p></td>
<td><p>Determines startup velocity</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-max-velocity-ratio"><span class="std std-ref">Maximum velocity</span></a></p></td>
<td><p>Determines maximum velocity command, as a ratio of nominal motor velocity</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-fullscale-base-ratio"><span class="std std-ref">Full-scale velocity</span></a></p></td>
<td><p>Determines full-scale velocity, as a ratio of nominal motor velocity</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-outer-loop-type"><span class="std std-ref">Outer loop controller</span></a></p></td>
<td><p>Determines the variable controlled by the outer control loop</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-saliency-threshold"><span class="std std-ref">Saliency: Saliency threshold</span></a></p></td>
<td><p>Determines saliency ratio below which the motor’s saliency is neglected</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-slewrate-accel"><span class="std std-ref">Slew rate: max acceleration</span></a></p></td>
<td><p>Determines maximum velocity slew rate in motoring quadrants</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-slewrate-decel"><span class="std std-ref">Slew rate: max deceleration</span></a></p></td>
<td><p>Determines maximum velocity slew rate in generating quadrants</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-dyn-current-type"><span class="std std-ref">Dynamic current limit type</span></a></p></td>
<td><p>Determines which type (if any) of dynamic current limit algorithm to use</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-stopping-type"><span class="std std-ref">Closed-loop stopping</span></a></p></td>
<td><p>Determines which type (if any) of closed-loop stopping to use</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-stopping-closed-loop-parameters-speed"><span class="std std-ref">Closed loop stopping: Speed</span></a></p></td>
<td><p>speed at which the motor is considered stopped</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-stopping-closed-loop-parameters-time"><span class="std std-ref">Closed loop stopping: Time</span></a></p></td>
<td><p>time duration where the motor is below the stopping speed, after which the motor is considered stopped</p></td>
</tr>
<tr class="row-odd"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-coastdown-end-velocity"><span class="std std-ref">Coastdown: Velocity threshold</span></a></p></td>
<td><p>Determines velocity threshold used to estimate when a motor stops</p></td>
</tr>
<tr class="row-even"><td><p>Operating parameters</p></td>
<td><p><a class="reference internal" href="#customize-operation-coastdown-time"><span class="std std-ref">Coastdown: Time</span></a></p></td>
<td><p>Determines time to wait until a motor stops</p></td>
</tr>
<tr class="row-odd"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-method"><span class="std std-ref">Flux control method</span></a></p></td>
<td><p>Selects flux control method (or “None” if disabled)</p></td>
</tr>
<tr class="row-even"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-eqn-based-ilimit-region-type"><span class="std std-ref">Current limit: Boundary type</span></a></p></td>
<td><p>Selects method used for defining the commanded Idq boundary</p></td>
</tr>
<tr class="row-odd"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-eqn-based-ilimit-id-limit"><span class="std std-ref">Current limit: Idmax</span></a></p></td>
<td><p>Determines the maximum negative d-axis current</p></td>
</tr>
<tr class="row-even"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-eqn-based-ilimit-iq-limit"><span class="std std-ref">Current limit: Iqmax</span></a></p></td>
<td><p>Determines the maximum q-axis current</p></td>
</tr>
<tr class="row-odd"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-eqn-based-fluxweak-enable"><span class="std std-ref">Flux weakening: enable</span></a></p></td>
<td><p>Determines if flux weakening is enabled</p></td>
</tr>
<tr class="row-even"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-eqn-based-fw-vdq-limit"><span class="std std-ref">Flux weakening: Voltage limit</span></a></p></td>
<td><p>Determines the voltage amplitude limit used in flux weakening (FW)</p></td>
</tr>
<tr class="row-odd"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-flux-control-eqn-based-mtpa-enable"><span class="std std-ref">MTPA: Enable</span></a></p></td>
<td><p>Determines if MTPA is enabled</p></td>
</tr>
<tr class="row-even"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-mtpa-indicators"><span class="std std-ref">MTPA: Idmax-MTPA</span></a></p></td>
<td><p>Displays the maximum d-axis current allocated to MTPA, as a function of <span class="math notranslate nohighlight">\(L_d - L_q\)</span> and <span class="math notranslate nohighlight">\(I_{\max}\)</span> (Indication only)</p></td>
</tr>
<tr class="row-odd"><td><p>Flux control</p></td>
<td><p><a class="reference internal" href="#customize-mtpa-indicators"><span class="std std-ref">MTPA: gain-MTPA</span></a></p></td>
<td><p>Displays the maximum increase in torque due to MTPA (Indication only)</p></td>
</tr>
<tr class="row-even"><td><p>Dead-time compensation</p></td>
<td><p><a class="reference internal" href="#customize-deadtimecomp-method"><span class="std std-ref">Dead-time compensation method</span></a></p></td>
<td><p>Selects dead-time compensation method (or “None” if disabled)</p></td>
</tr>
<tr class="row-odd"><td><p>Dead-time compensation</p></td>
<td><p><a class="reference internal" href="#customize-deadtimecomp-perphase-current-sign-band"><span class="std std-ref">Current linearity range</span></a></p></td>
<td><p>Determines linear range of currents used for deadtime compensation; larger currents are treated as ±1</p></td>
</tr>
<tr class="row-even"><td><p>Dead-time compensation</p></td>
<td><p><a class="reference internal" href="#customize-deadtimecomp-perphase-forward-gain"><span class="std std-ref">Forward gain</span></a></p></td>
<td><p>Determines gain for dead-time compensation in the forward path</p></td>
</tr>
<tr class="row-odd"><td><p>Dead-time compensation</p></td>
<td><p><a class="reference internal" href="#customize-deadtimecomp-perphase-feedback-gain"><span class="std std-ref">Feedback gain</span></a></p></td>
<td><p>Determines gain for dead-time compensation in the feedback path</p></td>
</tr>
<tr class="row-even"><td><p>Fault detection</p></td>
<td><p><a class="reference internal" href="#customize-fault-detect-margin-uv"><span class="std std-ref">Undervoltage margin</span></a></p></td>
<td><p>Determines undervoltage threshold margin</p></td>
</tr>
<tr class="row-odd"><td><p>Fault detection</p></td>
<td><p><a class="reference internal" href="#customize-fault-detect-margin-ov"><span class="std std-ref">Overvoltage margin</span></a></p></td>
<td><p>Determines overvoltage threshold margin</p></td>
</tr>
<tr class="row-even"><td><p>Fault detection</p></td>
<td><p><a class="reference internal" href="#customize-fault-detect-stall-detect-enable"><span class="std std-ref">Stall detect: enable</span></a></p></td>
<td><p>Determines if stall detect is enabled</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-istartup"><span class="std std-ref">Startup current</span></a></p></td>
<td><p>Determines current used during startup</p></td>
</tr>
<tr class="row-even"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-t-rampup"><span class="std std-ref">Rampup time</span></a></p></td>
<td><p>Determines current rampup time during startup</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-t-align"><span class="std std-ref">Align time</span></a></p></td>
<td><p>Determines time to remain in the align state during startup</p></td>
</tr>
<tr class="row-even"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-min-total-accel-time"><span class="std std-ref">Min accel time</span></a></p></td>
<td><p>Determines minimum acceleration time during startup</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-torque-scale-accel">Acceleration <span class="math notranslate nohighlight">\(\alpha_1\)</span></a></p></td>
<td><p>Determines fast acceleration rate</p></td>
</tr>
<tr class="row-even"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-torque-scale-slow-accel">Acceleration <span class="math notranslate nohighlight">\(\alpha_0\)</span></a></p></td>
<td><p>Determines slow acceleration rate</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-t-hold"><span class="std std-ref">Hold time</span></a></p></td>
<td><p>Determines time to remain in the hold state during startup</p></td>
</tr>
<tr class="row-even"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-omega0">Speed threshold <span class="math notranslate nohighlight">\(\omega_0\)</span></a></p></td>
<td><p>Determines speed threshold for switching to fast acceleration</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-theta-converge-rate"><span class="std std-ref">Angle converge rate</span></a></p></td>
<td><p>Determines rate of angle convergence during closed-loop transition of classic startup</p></td>
</tr>
<tr class="row-even"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-method"><span class="std std-ref">Startup algorithm</span></a></p></td>
<td><p>Selects startup method</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-damping-imax"><span class="std std-ref">Active damping: max amplitude</span></a></p></td>
<td><p>Determines maximum amplitude of active damping current</p></td>
</tr>
<tr class="row-even"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-damping-gainmax"><span class="std std-ref">Active damping: max gain</span></a></p></td>
<td><p>Determines maximum gain of active damping</p></td>
</tr>
<tr class="row-odd"><td><p>Startup</p></td>
<td><p><a class="reference internal" href="#customize-startup-damping-omega-min"><span class="std std-ref">Active damping: speed threshold</span></a></p></td>
<td><p>Determines the minimum velocity to enable active damping</p></td>
</tr>
<tr class="row-even"><td><p>Overmodulation</p></td>
<td><p><a class="reference internal" href="#customize-overmodulation-vd-limit"><span class="std std-ref">D-axis limit</span></a></p></td>
<td><p>Determines the maximum d-axis voltage</p></td>
</tr>
<tr class="row-odd"><td><p>Overmodulation</p></td>
<td><p><a class="reference internal" href="#customize-overmodulation-vq-limit"><span class="std std-ref">Q-axis limit</span></a></p></td>
<td><p>Determines the maximum q-axis voltage</p></td>
</tr>
<tr class="row-even"><td><p>Overmodulation</p></td>
<td><p><a class="reference internal" href="#customize-overmodulation-include-duty-clipping"><span class="std std-ref">Duty cycle feedback with clipping</span></a></p></td>
<td><p>Determines when in the forward path duty cycle feedback is obtained</p></td>
</tr>
<tr class="row-odd"><td><p>AN1292 PLL</p></td>
<td><p><a class="reference internal" href="#customize-pll-tau"><span class="std std-ref">Time constant</span></a></p></td>
<td><p>Specifies the velocity estimation time constant</p></td>
</tr>
<tr class="row-even"><td><p>AN1292 PLL</p></td>
<td><p><a class="reference internal" href="#customize-pll-omega1"><span class="std std-ref">Loop filter bandwidth</span></a></p></td>
<td><p>Specifies the loop filter bandwidth</p></td>
</tr>
<tr class="row-odd"><td><p>AN1292 PLL</p></td>
<td><p><a class="reference internal" href="#customize-pll-velocity-filter-threshold"><span class="std std-ref">Filter threshold</span></a></p></td>
<td><p>Determines maximum velocity for slow filtering in the PLL</p></td>
</tr>
<tr class="row-even"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-lines"><span class="std std-ref">Lines</span></a></p></td>
<td><p>Specifies the number of lines of the encoder</p></td>
</tr>
<tr class="row-odd"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-index-present"><span class="std std-ref">Index pulse present</span></a></p></td>
<td><p>Specifies whether an index pulse is present</p></td>
</tr>
<tr class="row-even"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-tracking-loop-tau"><span class="std std-ref">Tracking loop time constant</span></a></p></td>
<td><p>Determines bandwidth of tracking loop</p></td>
</tr>
<tr class="row-odd"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-method"><span class="std std-ref">Synchronization method</span></a></p></td>
<td><p>Selects method of synchronizing encoder with back-emf</p></td>
</tr>
<tr class="row-even"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-align-t-align"><span class="std std-ref">Align time</span></a></p></td>
<td><p>Duration of alignment phase of startup</p></td>
</tr>
<tr class="row-odd"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-align-angle-shift"><span class="std std-ref">Align angle shift</span></a></p></td>
<td><p>Determines angle shift between rampup and align states of startup</p></td>
</tr>
<tr class="row-even"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-align-angle-init"><span class="std std-ref">Align initial angle</span></a></p></td>
<td><p>Determines initial angle used in rampup state of startup</p></td>
</tr>
<tr class="row-odd"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-align-sweep-sweep-rate-pow"><span class="std std-ref">Align-and-sweep rate</span></a></p></td>
<td><p>Determines rotation rate during align state of startup, when using align-and-sweep method</p></td>
</tr>
<tr class="row-even"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-align-sweep-setup-angle"><span class="std std-ref">Align-and-sweep setup angle</span></a></p></td>
<td><p>Determines setup angle of align-and-sweep method, to allow transients to settle prior to measurements</p></td>
</tr>
<tr class="row-odd"><td><p>Quadrature encoder</p></td>
<td><p><a class="reference internal" href="#customize-encoder-qei-sync-pullout-pullout-slip"><span class="std std-ref">Pullout slip threshold</span></a></p></td>
<td><p>Determines rotor slip threshold used for detecting a pullout condition</p></td>
</tr>
<tr class="row-even"><td><p>Dynamic current limit</p></td>
<td><p><a class="reference internal" href="#customize-dyn-current1-peak-factor"><span class="std std-ref">Dynamic current limit</span></a></p></td>
<td><p>Determines peak current</p></td>
</tr>
<tr class="row-odd"><td><p>Dynamic current limit</p></td>
<td><p><a class="reference internal" href="#customize-dyn-current1-horizon-factor"><span class="std std-ref">Dynamic current limit</span></a></p></td>
<td><p>Determines horizon current</p></td>
</tr>
<tr class="row-even"><td><p>Dynamic current limit</p></td>
<td><p><a class="reference internal" href="#customize-dyn-current1-tau"><span class="std std-ref">Dynamic current limit</span></a></p></td>
<td><p>Determines relaxation time constant</p></td>
</tr>
<tr class="row-odd"><td><p>Dynamic current limit</p></td>
<td><p><a class="reference internal" href="#customize-dyn-current1-nsamples"><span class="std std-ref">Dynamic current limit</span></a></p></td>
<td><p>Determines decimation ratio</p></td>
</tr>
<tr class="row-even"><td><p>Voltage control</p></td>
<td><p><a class="reference internal" href="#customize-voltage-outerloop-tau-lpf"><span class="std std-ref">Low-pass filter time constant</span></a></p></td>
<td><p>Determines q-axis low pass filter time constant</p></td>
</tr>
<tr class="row-odd"><td><p>Voltage control</p></td>
<td><p><a class="reference internal" href="#customize-voltage-outerloop-kp"><span class="std std-ref">Proportional gain</span></a></p></td>
<td><p>Determines voltage controller proportional gain</p></td>
</tr>
<tr class="row-even"><td><p>Voltage control</p></td>
<td><p><a class="reference internal" href="#customize-voltage-outerloop-tau"><span class="std std-ref">Time constant</span></a></p></td>
<td><p>Determines voltage controller time constant</p></td>
</tr>
<tr class="row-odd"><td><p>Motion Control API</p></td>
<td><p><a class="reference internal" href="#customize-mcapi-issquaredtau"><span class="std std-ref">Filter time constant Is</span></a></p></td>
<td><p>Determines the time constant used for calculating low pass filtered value of amplitude of current in the motor (Is)</p></td>
</tr>
<tr class="row-even"><td><p>Motion Control API</p></td>
<td><p><a class="reference internal" href="#customize-mcapi-iqtau"><span class="std std-ref">Filter time constant Iq</span></a></p></td>
<td><p>Determines the time constant used for calculating low pass filtered value of the measured q-axis current in the motor (Iq)</p></td>
</tr>
<tr class="row-odd"><td><p>Motion Control API</p></td>
<td><p><a class="reference internal" href="#customize-mcapi-adcisruserfunctions-enable"><span class="std std-ref">ADC ISR user functions</span></a></p></td>
<td><p>Determines if the ADC ISR user functions are called periodically in the MCAF ISR</p></td>
</tr>
<tr class="row-even"><td><p>Board Service</p></td>
<td><p><a class="reference internal" href="#customize-board-service-uiservicetiming"><span class="std std-ref">UI service period</span></a></p></td>
<td><p>Determines the rate at which the board service ISR tasks get executed.</p></td>
</tr>
<tr class="row-odd"><td><p>Board Service</p></td>
<td><p><a class="reference internal" href="#customize-board-service-uibuttondebouncetime"><span class="std std-ref">Button debounce time</span></a></p></td>
<td><p>Determines the length of time required to register a logical high signal as a button press.</p></td>
</tr>
<tr class="row-even"><td><p>Board Service</p></td>
<td><p><a class="reference internal" href="#customize-board-service-uibuttonlongpresstime"><span class="std std-ref">Long button press time</span></a></p></td>
<td><p>Determines the amount of time before a button press is detected as a long button press.</p></td>
</tr>
<tr class="row-odd"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-vtempbridge"><span class="std std-ref">Temperature bridge</span></a></p></td>
<td><p>Determines if the temperature bridge ADC input is sampled</p></td>
</tr>
<tr class="row-even"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-temp-bridge-params-threshold"><span class="std std-ref">Temperature bridge: Overtemperature threshold</span></a></p></td>
<td><p>Determines threshold for triggering an overtemperature fault</p></td>
</tr>
<tr class="row-odd"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-temp-bridge-params-tau-lpf"><span class="std std-ref">Temperature bridge: Time constant</span></a></p></td>
<td><p>Determines temperature low-pass filter time constant</p></td>
</tr>
<tr class="row-even"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-temp-bridge-params-slewrate"><span class="std std-ref">Temperature bridge: Slew rate</span></a></p></td>
<td><p>Determines temperature slew rate</p></td>
</tr>
<tr class="row-odd"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-vabsref"><span class="std std-ref">Absolute voltage reference</span></a></p></td>
<td><p>Determines if the absolute voltage reference ADC input is sampled</p></td>
</tr>
<tr class="row-even"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-vphasea"><span class="std std-ref">Phase voltage: A</span></a></p></td>
<td><p>Determines if the phase A ADC input is sampled</p></td>
</tr>
<tr class="row-odd"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-vphaseb"><span class="std std-ref">Phase voltage: B</span></a></p></td>
<td><p>Determines if the phase C ADC input is sampled</p></td>
</tr>
<tr class="row-even"><td><p>Optional analog inputs</p></td>
<td><p><a class="reference internal" href="#customize-adc-vphasec"><span class="std std-ref">Phase voltage: C</span></a></p></td>
<td><p>Determines if the phase C ADC input is sampled</p></td>
</tr>
</tbody>
</table>
</section>
<section id="detailed-information">
<h2><span class="section-number">6.3.2. </span>Detailed information<a class="headerlink" href="#detailed-information" title="Permalink to this heading">¶</a></h2>
<section id="current-measurement">
<span id="customize-current-measure-method"></span><h3><span class="section-number">6.3.2.1. </span>Current measurement<a class="headerlink" href="#current-measurement" title="Permalink to this heading">¶</a></h3>
<p>Several current measurement algorithms have been implemented for obtaining phase current
measurements and adapting them for use in the feedback path of field-oriented control.
Each method has different hardware requirements, and are available depending on the current
measurement capability of the selected board:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-single-channel"><span class="std std-ref">Single channel (“single-shunt”)</span></a> — requires a DC link current shunt resistor</p></li>
<li><p><a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-dual-channel"><span class="std std-ref">Dual channel (“dual-shunt”)</span></a> — requires two phase current shunt resistors</p></li>
<li><p><a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-triple-channel"><span class="std std-ref">Triple channel (“triple-shunt”)</span></a> — requires three phase current shunt resistors</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
<section id="single-channel">
<h4><span class="section-number">6.3.2.1.1. </span>Single channel<a class="headerlink" href="#single-channel" title="Permalink to this heading">¶</a></h4>
<p><a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-single-channel"><span class="std std-ref">Single channel (“single-shunt”)</span></a> samples the DC link
current at different inverter switching states to reconstruct the three phase currents.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
<section id="minimum-time-window">
<span id="customize-current-measure-single-channel-minimumtime"></span><h5><span class="section-number">6.3.2.1.1.1. </span>Minimum time window<a class="headerlink" href="#minimum-time-window" title="Permalink to this heading">¶</a></h5>
<p>Minimum time window <span class="math notranslate nohighlight">\(t_{\mathrm{sample}}\)</span> required to measure current signal using single channel.
This time is added to the PWM dead time so that <span class="math notranslate nohighlight">\(t_{\mathrm{crit}} = t_{\mathrm{deadtime}} + t_{\mathrm{sample}}\)</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="adc-trigger-delay">
<span id="customize-current-measure-single-channel-sampledelay"></span><h5><span class="section-number">6.3.2.1.1.2. </span>ADC trigger delay<a class="headerlink" href="#adc-trigger-delay" title="Permalink to this heading">¶</a></h5>
<p>Delay between the inverter switching state and the ADC sampling point. This delay may be required
to avoid ringing current signals due to the inverter switching state, which can reduce the accuracy
of single channel current measurement.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
</section>
<section id="estimators">
<h3><span class="section-number">6.3.2.2. </span>Estimators<a class="headerlink" href="#estimators" title="Permalink to this heading">¶</a></h3>
<section id="primary-estimator">
<span id="customize-estimator-type"></span><h4><span class="section-number">6.3.2.2.1. </span>Primary estimator<a class="headerlink" href="#primary-estimator" title="Permalink to this heading">¶</a></h4>
<p>One position and velocity estimator must be chosen
for use in commutation and velocity feedback.</p>
<p>Available estimators as of MCAF R7:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../algorithms/pll.html#algorithm-pll"><span class="std std-ref">AN1292 Phase-locked Loop (PLL)</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/atpll.html#algorithm-atpll"><span class="std std-ref">Angle-tracking Phase-locked Loop (ATPLL)</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/qei.html#algorithm-qei"><span class="std std-ref">Quadrature encoder</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/zsmt.html#algorithm-zsmt"><span class="std std-ref">Zero-Speed / Maximum Torque (ZS/MT)</span></a></p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
<p>(Previously this choice was made on the Configure page in motorBench<sup>®</sup> Development Suite.)</p>
</section>
<section id="active-estimators">
<span id="customize-estimator-active"></span><h4><span class="section-number">6.3.2.2.2. </span>Active estimators<a class="headerlink" href="#active-estimators" title="Permalink to this heading">¶</a></h4>
<p>In addition to the primary estimator, additional estimators
may be selected. (Only the primary estimator is used for commutation
and velocity feedback.)</p>
<p>Usage of more than one estimator — particularly the quadrature encoder,
which has higher angle and velocity accuracy — is recommended for troubleshooting
or validation purposes. Please note that this will increase
CPU and memory requirements.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
</section>
<section id="operating-parameters">
<h3><span class="section-number">6.3.2.3. </span>Operating parameters<a class="headerlink" href="#operating-parameters" title="Permalink to this heading">¶</a></h3>
<section id="minimum-velocity">
<span id="customize-operation-min-velocity-ratio"></span><h4><span class="section-number">6.3.2.3.1. </span>Minimum velocity<a class="headerlink" href="#minimum-velocity" title="Permalink to this heading">¶</a></h4>
<p>Minimum velocity <span class="math notranslate nohighlight">\(\omega_{\min}\)</span> was moved in MCAF R5 to the Customize
page from the Configure page. It is used in MCAF in two ways:</p>
<ul class="simple">
<li><p>Determines the lower limit of the adjustable velocity range</p></li>
<li><p>In autotuning, determines dynamics of the sensorless estimator model;
stability and performance of sensorless estimators are poorer at lower
velocities, so lowering the minimum velocity will generally result
in a lower-bandwidth velocity control loop to ensure stability.</p></li>
</ul>
<p>Minimum velocity <span class="math notranslate nohighlight">\(\omega_{\min}\)</span> was previously used as the transition velocity
at motor startup. As of MCAF R7, the <a class="reference internal" href="#customize-operation-startup-velocity-ratio"><span class="std std-ref">startup velocity</span></a>
parameter determines the transition velocity at motor startup.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="startup-velocity">
<span id="customize-operation-startup-velocity-ratio"></span><h4><span class="section-number">6.3.2.3.2. </span>Startup velocity<a class="headerlink" href="#startup-velocity" title="Permalink to this heading">¶</a></h4>
<p>Determines the transition velocity at motor startup <span class="math notranslate nohighlight">\(\omega_1\)</span>, from open-loop commutation
to closed-loop commutation. (Before MCAF R7, minimum velocity <span class="math notranslate nohighlight">\(\omega_{\min}\)</span> was used.)
This parameter is constrained so that startup velocity <span class="math notranslate nohighlight">\(\omega_1\)</span> must be greater than or
equal to minimum velocity <span class="math notranslate nohighlight">\(\omega_{\min}\)</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="maximum-velocity">
<span id="customize-operation-max-velocity-ratio"></span><h4><span class="section-number">6.3.2.3.3. </span>Maximum velocity<a class="headerlink" href="#maximum-velocity" title="Permalink to this heading">¶</a></h4>
<p>Increase or decrease the maximum allowed velocity command, as a ratio of nominal motor
velocity. The default value is sufficient in most cases. Increasing may be appropriate
for motors with a wide flux weakening range above the nominal velocity.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="full-scale-velocity">
<span id="customize-operation-fullscale-base-ratio"></span><h4><span class="section-number">6.3.2.3.4. </span>Full-scale velocity<a class="headerlink" href="#full-scale-velocity" title="Permalink to this heading">¶</a></h4>
<p>The full-scale velocity controls the numerical representation of motor velocity. Increase
to allow more design margin against overflow.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="outer-loop-controller">
<span id="customize-operation-outer-loop-type"></span><h4><span class="section-number">6.3.2.3.5. </span>Outer loop controller<a class="headerlink" href="#outer-loop-controller" title="Permalink to this heading">¶</a></h4>
<p>There are two choices for the variable that is controlled by the outer loop controller:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../components/foc.html#velocity-control"><span class="std std-ref">Velocity</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">Voltage</span></a></p></li>
</ul>
<p>The velocity controller parameters are configurable in the tuning page, while the voltage
controller <a class="reference internal" href="#customize-voltage-outerloop"><span class="std std-ref">parameters</span></a> are configurable in the Customize
page.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="saliency-threshold">
<span id="customize-saliency-threshold"></span><h4><span class="section-number">6.3.2.3.6. </span>Saliency threshold<a class="headerlink" href="#saliency-threshold" title="Permalink to this heading">¶</a></h4>
<p>Saliency ratio <span class="math notranslate nohighlight">\(\xi = L_q/L_d\)</span>  helps determine whether the full-saliency motor model
is used. This is a more complicated motor model, used in certain algorithms such as the
<a class="reference internal" href="../algorithms/atpll.html#algorithm-atpll"><span class="std std-ref">ATPLL</span></a> estimator, <a class="reference internal" href="../algorithms/flux_control/mtpa.html#algorithm-mtpa"><span class="std std-ref">MTPA</span></a>, and
<a class="reference internal" href="../algorithms/flux_control/mtpa.html#algorithm-mtpa"><span class="std std-ref">flux weakening</span></a>. The full-saliency motor model takes both inductances
into account, but requires slightly more computation. Since most permanent-magnet motors are
non-salient, <span class="math notranslate nohighlight">\(\xi \approx 1\)</span> and the saliency can be neglected, saving CPU cycles.</p>
<p>This threshold sets the minimum saliency to use the full-saliency motor model. Increasing the
threshold can be used to neglect saliency if the extra computation is not desirable.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="slew-rate-max-acceleration-deceleration">
<span id="customize-operation-slewrate-decel"></span><span id="customize-operation-slewrate-accel"></span><h4><span class="section-number">6.3.2.3.7. </span>Slew rate (max acceleration/deceleration)<a class="headerlink" href="#slew-rate-max-acceleration-deceleration" title="Permalink to this heading">¶</a></h4>
<p>Maximum acceleration (in motoring quadrants) and deceleration (in generating quadrants)
can be adjusted. Increasing the slew rates will increase the motor current required during
acceleration or deceleration.</p>
<p>Determining maximum deceleration during regeneration must be done with some care: the motor drive
converts mechanical energy into electrical energy, which must go somewhere, such as a battery
or a dynamic brake resistor. Without a viable outlet for that energy,
the DC link voltage will rise until
the motor controller detects this and shuts down, or until one of the capacitors or transistors
fails and dissipates this energy destructively.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="dynamic-current-limit-type">
<span id="customize-operation-dyn-current-type"></span><h4><span class="section-number">6.3.2.3.8. </span>Dynamic current limit type<a class="headerlink" href="#dynamic-current-limit-type" title="Permalink to this heading">¶</a></h4>
<p>The controlled d-axis and q-axis currents may have a fixed limit, or the limit may change based on the
motor current if short higher-current transients are desired. Two options are available for dynamic
current limit:</p>
<ul class="simple">
<li><p>None</p></li>
<li><p><a class="reference internal" href="#customize-dyn-current1"><span class="std std-ref">Simple</span></a></p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="closed-loop-stopping">
<span id="customize-operation-stopping-type"></span><h4><span class="section-number">6.3.2.3.9. </span>Closed-loop stopping<a class="headerlink" href="#closed-loop-stopping" title="Permalink to this heading">¶</a></h4>
<p>There are three stopping modes in MCAF that affect the
<a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping"><span class="std std-ref">motor stopping behavior</span></a> in the <code class="docutils literal notranslate"><span class="pre">STOPPING</span></code> state.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping-min-impact"><span class="std std-ref">Minimal-impact PWM</span></a> —
Phase currents quickly reach zero. Does not allow estimators to operate during stopping.</p></li>
<li><p><a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping-closed-loop-current"><span class="std std-ref">Closed-loop current</span></a> —
Controls the q-axis current to zero. Allows estimators to operate during stopping.</p></li>
<li><p><a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping-closed-loop-velocity"><span class="std std-ref">Closed-loop velocity</span></a> —
Controls the velocity to zero. Allows estimators to operate during stopping.</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
<section id="speed-and-time-thresholds">
<span id="customize-operation-stopping-closed-loop-parameters-time"></span><span id="customize-operation-stopping-closed-loop-parameters-speed"></span><h5><span class="section-number">6.3.2.3.9.1. </span>Speed and time thresholds<a class="headerlink" href="#speed-and-time-thresholds" title="Permalink to this heading">¶</a></h5>
<p>There are two closed-loop stopping parameters used to define the condition at which the motor is considered
stopped, before the state machine transitions from the <code class="docutils literal notranslate"><span class="pre">STOPPING</span></code> state  to the <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code> state.</p>
<ul class="simple">
<li><p>Speed threshold</p></li>
<li><p>Time threshold</p></li>
</ul>
<p>For a transition from <code class="docutils literal notranslate"><span class="pre">STOPPING</span></code> to <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code>, the motor speed must fall and remain below the speed
threshold for at least the time threshold. This implementation is to avoid short speed transients below the
speed threshold causing a false motor stop. <a class="reference internal" href="#fig-customize-closed-loop-stopping-example"><span class="std std-numref">Figure 6.1</span></a> shows an
example with the speed threshold set to 75 RPM and the time threshold set to 1.0 s. The state machine transitions
to STOPPED only when the time threshold has fully elapsed while the motor speed remains below the speed threshold.</p>
<figure class="align-center" id="id7">
<span id="fig-customize-closed-loop-stopping-example"></span><img alt="../_images/customize-closed-loop-stopping-example.png" src="../_images/customize-closed-loop-stopping-example.png" />
<figcaption>
<p><span class="caption-number">Figure 6.1 </span><span class="caption-text">State machine transition from STOPPING to STOPPED with closed-loop stopping active.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
<section id="coastdown-parameters">
<span id="customize-operation-coastdown-time"></span><span id="customize-operation-coastdown-end-velocity"></span><h4><span class="section-number">6.3.2.3.10. </span>Coastdown parameters<a class="headerlink" href="#coastdown-parameters" title="Permalink to this heading">¶</a></h4>
<p>With <a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping-min-impact"><span class="std std-ref">the stopping mode set to minimal-impact PWM</span></a>,
there are two interrelated coastdown parameters used to estimate
the time required to bring the motor to a stop, before it can be
safely restarted:</p>
<ul class="simple">
<li><p>velocity threshold</p></li>
<li><p>time</p></li>
</ul>
<p>The resulting coastdown time is used in the <code class="docutils literal notranslate"><span class="pre">STOPPING</span></code> <a class="reference internal" href="../components/statemach.html#component-statemachine-states"><span class="std std-ref">state</span></a> before
proceeding to the <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code> <a class="reference internal" href="../components/statemach.html#component-statemachine-states"><span class="std std-ref">state</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
</section>
<section id="flux-control">
<span id="customize-flux-control"></span><h3><span class="section-number">6.3.2.4. </span>Flux control<a class="headerlink" href="#flux-control" title="Permalink to this heading">¶</a></h3>
<p>See the section on <a class="reference internal" href="../algorithms/flux_control/index.html#algorithm-flux-control"><span class="std std-ref">flux control</span></a> for more information.</p>
<section id="flux-control-method">
<span id="customize-flux-control-method"></span><h4><span class="section-number">6.3.2.4.1. </span>Flux control method<a class="headerlink" href="#flux-control-method" title="Permalink to this heading">¶</a></h4>
<p>Selects which <a class="reference internal" href="../algorithms/flux_control/index.html#algorithm-flux-control"><span class="std std-ref">flux control</span></a> method is used, from among the following:</p>
<ul class="simple">
<li><p>“None” — d-axis reference current will be set to zero</p></li>
<li><p>“Equation-based” — determines d-axis reference current from the
<a class="reference internal" href="../algorithms/flux_control/flux_weakening.html#algorithm-flux-weakening"><span class="std std-ref">flux weakening</span></a> and <a class="reference internal" href="../algorithms/flux_control/mtpa.html#algorithm-mtpa"><span class="std std-ref">MTPA</span></a> algorithms</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="current-limit-boundary-type">
<span id="customize-flux-control-eqn-based-ilimit-region-type"></span><h4><span class="section-number">6.3.2.4.2. </span>Current limit: Boundary type<a class="headerlink" href="#current-limit-boundary-type" title="Permalink to this heading">¶</a></h4>
<p>Rectangular type sets d-axis and q-axis current limits independently. Quadratic type sets the q-axis limit
based on a quadratic approximation of a circular function.</p>
<p>See also <a class="reference internal" href="../algorithms/flux_control/flux_weakening_mtpa_integration.html#algorithm-fluxctrl-iqlim"><span class="std std-ref">Calculation of q-axis current limit</span></a> for more information.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="current-limit-idmax">
<span id="customize-flux-control-eqn-based-ilimit-id-limit"></span><h4><span class="section-number">6.3.2.4.3. </span>Current limit: Idmax<a class="headerlink" href="#current-limit-idmax" title="Permalink to this heading">¶</a></h4>
<p>The d-axis current is normalized to maximum current Imax, where Imax = minimum of motor and drive continuous
current ratings. It is recommended to set the current limit below the demagnetizing current of the motor.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="current-limit-iqmax">
<span id="customize-flux-control-eqn-based-ilimit-iq-limit"></span><h4><span class="section-number">6.3.2.4.4. </span>Current limit: Iqmax<a class="headerlink" href="#current-limit-iqmax" title="Permalink to this heading">¶</a></h4>
<p>The q-axis current limit is allocated as a fraction of current limit Imax, where Imax = minimum of motor and
drive continuous current ratings. This is applicable only when rectangular boundary type is enabled.</p>
<p>See also <a class="reference internal" href="../algorithms/flux_control/flux_weakening_mtpa_integration.html#algorithm-fluxctrl-iqlim"><span class="std std-ref">Calculation of q-axis current limit</span></a> for more information.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="flux-weakening-enable">
<span id="customize-flux-control-eqn-based-fluxweak-enable"></span><h4><span class="section-number">6.3.2.4.5. </span>Flux weakening: enable<a class="headerlink" href="#flux-weakening-enable" title="Permalink to this heading">¶</a></h4>
<p>This parameter determines if flux weakening is enabled.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="flux-weakening-voltage-limit">
<span id="customize-flux-control-eqn-based-fw-vdq-limit"></span><h4><span class="section-number">6.3.2.4.6. </span>Flux weakening: voltage limit<a class="headerlink" href="#flux-weakening-voltage-limit" title="Permalink to this heading">¶</a></h4>
<p>The voltage amplitude limit used in <a class="reference internal" href="../algorithms/flux_control/flux_weakening.html#algorithm-flux-weakening"><span class="std std-ref">flux weakening</span></a> (FW) is normalized to DC
link voltage. D-axis current is computed so that the steady-state voltage requirements do not exceed this circular
limit. Ideally a limit is chosen so that the motor enters FW operation just before entering
<a class="reference internal" href="../algorithms/foc/overmodulation.html#algorithm-overmodulation"><span class="std std-ref">overmodulation</span></a>. Higher limits may prevent the motor from entering FW region.
Lower limits guarantee FW operation, at the cost of extra power dissipation.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="mtpa-enable">
<span id="customize-flux-control-eqn-based-mtpa-enable"></span><h4><span class="section-number">6.3.2.4.7. </span>MTPA: Enable<a class="headerlink" href="#mtpa-enable" title="Permalink to this heading">¶</a></h4>
<p>This parameter determines if MTPA is enabled.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="mtpa-display-calculations">
<span id="customize-mtpa-indicators"></span><h4><span class="section-number">6.3.2.4.8. </span>MTPA display calculations<a class="headerlink" href="#mtpa-display-calculations" title="Permalink to this heading">¶</a></h4>
<p><a class="reference internal" href="../algorithms/flux_control/mtpa.html#algorithm-mtpa"><span class="std std-ref">MTPA</span></a> does not have any user-configurable parameters,
but does include two display values for indication only:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I_{\textnormal{dmax\_mtpa}}\)</span> — displays the maximum d-axis current
reference that can occur from MTPA</p></li>
<li><p><span class="math notranslate nohighlight">\(G_{\textnormal{mtpa}}\)</span> — displays the maximum torque gain
that can occur from the use of MTPA,
relative to the maximum torque with MTPA disabled (<span class="math notranslate nohighlight">\(I_d = 0\)</span>).</p></li>
</ul>
<p>Both are generally very small, except for motors that have
significant rotor saliency and high flux utilization.
The saliency flux utilization coefficient
<span class="math notranslate nohighlight">\(\alpha_{\textrm{mtpa}} = (L_q-L_d)I_{\max}/\psi_m\)</span>
is a metric of rotor saliency and flux utilization,
and represents how much change in air-gap flux can occur, relative
to the permanent magnet flux.</p>
<p>The maximum d-axis current and maximum torque gain are approximately
proportional to <span class="math notranslate nohighlight">\(\alpha_{\textrm{mtpa}}{}^2\)</span>, so doubling
the overall current capability <span class="math notranslate nohighlight">\(I_{\max}\)</span> roughly quadruples both the d-axis current requested by MPTA and
the contribution of MTPA towards torque.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
</section>
<section id="dead-time-compensation">
<span id="customize-deadtimecomp"></span><h3><span class="section-number">6.3.2.5. </span>Dead-time compensation<a class="headerlink" href="#dead-time-compensation" title="Permalink to this heading">¶</a></h3>
<p>See the section on <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-deadtimecompensation"><span class="std std-ref">dead-time compensation</span></a> for more information.</p>
<section id="dead-time-compensation-method">
<span id="customize-deadtimecomp-method"></span><h4><span class="section-number">6.3.2.5.1. </span>Dead-time compensation method<a class="headerlink" href="#dead-time-compensation-method" title="Permalink to this heading">¶</a></h4>
<p>Selects which <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-deadtimecompensation"><span class="std std-ref">dead-time compensation</span></a> method is used, from among the following:</p>
<ul class="simple">
<li><p>“None” — no dead-time compensation is required</p></li>
<li><p>“Per-phase” — uses the <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-dtc-perphase"><span class="std std-ref">per-phase dead-time compensation algorithm</span></a></p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="current-linearity-range">
<span id="customize-deadtimecomp-perphase-current-sign-band"></span><h4><span class="section-number">6.3.2.5.2. </span>Current linearity range<a class="headerlink" href="#current-linearity-range" title="Permalink to this heading">¶</a></h4>
<p>Determines the maximum amplitude <span class="math notranslate nohighlight">\(I_\delta\)</span> for which a linear range of current is used in calculating unit
disturbance signals <span class="math notranslate nohighlight">\(\hat{s}_{abc}\)</span> — see <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-dtc-perphase"><span class="std std-ref">per-phase dead-time compensation</span></a>
and the <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-dtc-current-linearity"><span class="std std-ref">current linearity range</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="forward-gain">
<span id="customize-deadtimecomp-perphase-forward-gain"></span><h4><span class="section-number">6.3.2.5.3. </span>Forward gain<a class="headerlink" href="#forward-gain" title="Permalink to this heading">¶</a></h4>
<p>Determines the dead-time compensation gain used in the forward path to mitigate the effects of dead time distortion at
high electrical frequencies. Unless this type of dead-time compensation is tested carefully with a specific motor, the
default value of zero is recommended. See <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-dtc-gain-fwd"><span class="std std-ref">forward-path gain</span></a> for more information.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="feedback-gain">
<span id="customize-deadtimecomp-perphase-feedback-gain"></span><h4><span class="section-number">6.3.2.5.4. </span>Feedback gain<a class="headerlink" href="#feedback-gain" title="Permalink to this heading">¶</a></h4>
<p>Determines the dead-time compensation gain used in the feedback path to mitigate the effects of dead time distortion on
sensorless estimators at low speeds. Increasing this gain will generally improve sensorless estimator performance at low
speeds, but excessive gain may cause the current command to jump to its positive limit. See
<a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-dtc-gain-fb"><span class="std std-ref">feedback-path gain</span></a> for more information.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
</section>
<section id="fault-detection">
<span id="customize-fault-detect"></span><h3><span class="section-number">6.3.2.6. </span>Fault detection<a class="headerlink" href="#fault-detection" title="Permalink to this heading">¶</a></h3>
<section id="undervoltage-margin">
<span id="customize-fault-detect-margin-uv"></span><h4><span class="section-number">6.3.2.6.1. </span>Undervoltage margin<a class="headerlink" href="#undervoltage-margin" title="Permalink to this heading">¶</a></h4>
<p>Determines the point at which the motor controller shuts down due to insufficient available voltage
below its minimum operating voltage.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="overvoltage-margin">
<span id="customize-fault-detect-margin-ov"></span><h4><span class="section-number">6.3.2.6.2. </span>Overvoltage margin<a class="headerlink" href="#overvoltage-margin" title="Permalink to this heading">¶</a></h4>
<p>Determines the point at which the motor controller shuts down due to excessive voltage
above its maximum operating voltage.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="stall-detect-enable">
<span id="customize-fault-detect-stall-detect-enable"></span><h4><span class="section-number">6.3.2.6.3. </span>Stall detect: enable<a class="headerlink" href="#stall-detect-enable" title="Permalink to this heading">¶</a></h4>
<p>Determines if the <a class="reference internal" href="../architecture/statemach.html#architecture-statemachine"><span class="std std-ref">state machine</span></a> enters the FAULT state due
to a <a class="reference internal" href="../components/supervisory.html#supervisory-stall-detect"><span class="std std-ref">stall detect</span></a> condition. Disabling the stall detect feature
will exclude stall detect algorithms from the project build, reducing average CPU usage and memory
requirements. Prior to MCAF R7, stall detection was enabled by default and not controllable through
the Customize page.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
<section id="startup">
<span id="customize-startup"></span><h3><span class="section-number">6.3.2.7. </span>Startup<a class="headerlink" href="#startup" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../algorithms/startup.html#startup-sequence"><span class="std std-ref">startup sequence</span></a> has numerous
parameters that can be modified. These are shown in
<a class="reference internal" href="#fig-customize-startup-sequence"><span class="std std-numref">Figure 6.2</span></a>.</p>
<figure class="align-center" id="id8">
<span id="fig-customize-startup-sequence"></span><img alt="../_images/startup-sequence.png" src="../_images/startup-sequence.png" />
<figcaption>
<p><span class="caption-number">Figure 6.2 </span><span class="caption-text">Graph of current and electrical frequency in startup sequence.
(The Weathervane startup algorithm is shown.)</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<section id="startup-current">
<span id="customize-startup-istartup"></span><h4><span class="section-number">6.3.2.7.1. </span>Startup current<a class="headerlink" href="#startup-current" title="Permalink to this heading">¶</a></h4>
<p>Startup current amplitude <span class="math notranslate nohighlight">\(I_{q0}\)</span> represents a tradeoff between
making startup robust (higher is better) and reducing power dissipation
in the motor (lower is better). There’s not much value in reducing it
below 0.5, which specifies half of maximum continuous current.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="rampup-time">
<span id="customize-startup-t-rampup"></span><h4><span class="section-number">6.3.2.7.2. </span>Rampup time<a class="headerlink" href="#rampup-time" title="Permalink to this heading">¶</a></h4>
<p>Current rampup time <span class="math notranslate nohighlight">\(t_r\)</span> affects only the initial state of startup, in which current increases from zero to its
maximum amplitude. The current rampup time should be slow compared to <span class="math notranslate nohighlight">\(L/R\)</span>, so that it represents a smooth
transition, but fast compared to the overall startup time.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="align-time">
<span id="customize-startup-t-align"></span><h4><span class="section-number">6.3.2.7.3. </span>Align time<a class="headerlink" href="#align-time" title="Permalink to this heading">¶</a></h4>
<p>Some motors, especially those with large inertia and cogging torque,
may start more reliably with align time <span class="math notranslate nohighlight">\(t_{\mathrm{aln}} &gt; 0\)</span>.
The default value of zero is sufficient in most cases.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="min-accel-time">
<span id="customize-startup-min-total-accel-time"></span><h4><span class="section-number">6.3.2.7.4. </span>Min accel time<a class="headerlink" href="#min-accel-time" title="Permalink to this heading">¶</a></h4>
<p>Increase the minimum acceleration time <span class="math notranslate nohighlight">\(t_{\mathrm{acc}}\)</span> if a slower, less-aggressive startup is desired.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="customize-startup-torque-scale-accel">
<span id="id1"></span><h4><span class="section-number">6.3.2.7.5. </span>Acceleration <span class="math notranslate nohighlight">\(\alpha_1\)</span><a class="headerlink" href="#customize-startup-torque-scale-accel" title="Permalink to this heading">¶</a></h4>
<p>Increase or decrease the acceleration rate <span class="math notranslate nohighlight">\(\alpha_1\)</span> to control the faster second phase of acceleration.
Slower acceleration is generally less prone to cycle slips, but takes longer.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="customize-startup-torque-scale-slow-accel">
<span id="id2"></span><h4><span class="section-number">6.3.2.7.6. </span>Acceleration <span class="math notranslate nohighlight">\(\alpha_0\)</span><a class="headerlink" href="#customize-startup-torque-scale-slow-accel" title="Permalink to this heading">¶</a></h4>
<p>Increase or decrease the acceleration rate <span class="math notranslate nohighlight">\(\alpha_0\)</span> to control the slower first phase of acceleration.
(Note: this is normalized to <span class="math notranslate nohighlight">\(\alpha_1\)</span>.)
Slower acceleration is generally less prone to cycle slips, but takes longer.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="hold-time">
<span id="customize-startup-t-hold"></span><h4><span class="section-number">6.3.2.7.7. </span>Hold time<a class="headerlink" href="#hold-time" title="Permalink to this heading">¶</a></h4>
<p>The hold time <span class="math notranslate nohighlight">\(t_h\)</span> controls how long the startup sequence
remains in the <code class="docutils literal notranslate"><span class="pre">HOLD</span></code> state where electrical frequency and current
are both held constant before transitioning to closed-loop commutation.</p>
<p>A value of zero is fine in most cases.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="customize-startup-omega0">
<span id="id3"></span><h4><span class="section-number">6.3.2.7.8. </span>Speed threshold <span class="math notranslate nohighlight">\(\omega_0\)</span><a class="headerlink" href="#customize-startup-omega0" title="Permalink to this heading">¶</a></h4>
<p>Decreasing the velocity threshold <span class="math notranslate nohighlight">\(\omega_0\)</span> will switch to the faster second phase of acceleration sooner.</p>
<p>(Note that the threshold <span class="math notranslate nohighlight">\(\omega_{\min}\)</span> is determined by the <a class="reference internal" href="#customize-operation-min-velocity-ratio"><span class="std std-ref">minimum
velocity setting</span></a> under Operating parameters.)</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="angle-converge-rate">
<span id="customize-startup-theta-converge-rate"></span><h4><span class="section-number">6.3.2.7.9. </span>Angle converge rate<a class="headerlink" href="#angle-converge-rate" title="Permalink to this heading">¶</a></h4>
<p>The angle converge rate controls how fast the transition from
open-loop to closed-loop commutation with the <a class="reference internal" href="../algorithms/startup.html#startup-classic"><span class="std std-ref">Classic</span></a> startup method.</p>
<p>Some motors may require a lower value to ensure a smooth
transition to closed-loop commutation, typically in the
range of 0.1°/ms – 1.0°/ms.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="startup-algorithm">
<span id="customize-startup-method"></span><h4><span class="section-number">6.3.2.7.10. </span>Startup algorithm<a class="headerlink" href="#startup-algorithm" title="Permalink to this heading">¶</a></h4>
<p><a class="reference internal" href="../algorithms/startup.html#startup-classic"><span class="std std-ref">Classic</span></a> is the algorithm provided in MCAF R1 – R3. <a class="reference internal" href="../algorithms/startup.html#startup-weathervane"><span class="std std-ref">Weathervane</span></a>
transitions to closed-loop more quickly than the Classic algorithm, and was added in R4.</p>
<p><a class="reference internal" href="../algorithms/startup.html#startup-zsmt-ipc"><span class="std std-ref">ZS/MT + Initial position correction</span></a> was added in MCAF R7,
and is required by the <a class="reference internal" href="../algorithms/zsmt.html#algorithm-zsmt"><span class="std std-ref">ZS/MT estimator</span></a>.</p>
<p>See <a class="reference internal" href="../algorithms/startup.html#startup-which-method"><span class="std std-ref">choice of startup method</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="active-damping-max-amplitude">
<span id="customize-startup-damping-imax"></span><h4><span class="section-number">6.3.2.7.11. </span>Active damping: max amplitude<a class="headerlink" href="#active-damping-max-amplitude" title="Permalink to this heading">¶</a></h4>
<p>Controls the amplitude of active damping <span class="math notranslate nohighlight">\(I_\Delta\)</span>. Reduce this value if startup
is noisy or unstable. Set to zero to eliminate active damping completely.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="active-damping-max-gain">
<span id="customize-startup-damping-gainmax"></span><h4><span class="section-number">6.3.2.7.12. </span>Active damping: max gain<a class="headerlink" href="#active-damping-max-gain" title="Permalink to this heading">¶</a></h4>
<p>Controls the feedback gain of active damping. Reduce this value if startup
is noisy or unstable.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="active-damping-speed-threshold">
<span id="customize-startup-damping-omega-min"></span><h4><span class="section-number">6.3.2.7.13. </span>Active damping: speed threshold<a class="headerlink" href="#active-damping-speed-threshold" title="Permalink to this heading">¶</a></h4>
<p>Determines the minimum velocity to enable active damping.
Make sure to choose a velocity where the estimator is stable enough
to be useful for active damping.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
</section>
<section id="overmodulation">
<h3><span class="section-number">6.3.2.8. </span>Overmodulation<a class="headerlink" href="#overmodulation" title="Permalink to this heading">¶</a></h3>
<p>See the section on <a class="reference internal" href="../algorithms/foc/overmodulation.html#algorithm-overmodulation"><span class="std std-ref">overmodulation</span></a> for more information.</p>
<section id="d-axis-limit">
<span id="customize-overmodulation-vd-limit"></span><h4><span class="section-number">6.3.2.8.1. </span>D-axis limit<a class="headerlink" href="#d-axis-limit" title="Permalink to this heading">¶</a></h4>
<p>Determines the maximum d-axis voltage.
Leaving this at 1.0 is recommended.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="q-axis-limit">
<span id="customize-overmodulation-vq-limit"></span><h4><span class="section-number">6.3.2.8.2. </span>Q-axis limit<a class="headerlink" href="#q-axis-limit" title="Permalink to this heading">¶</a></h4>
<p>Determines the maximum q-axis voltage.
A value between 1.05 and 1.25 is recommended.
Larger values will allow higher output voltage amplitude,
at the cost of higher distortion in output voltage and current.</p>
<p>The section on <a class="reference internal" href="../algorithms/foc/overmodulation.html#overmodulation-behavior-dq"><span class="std std-ref">overmodulation behavior in the synchronous frame</span></a>
has more information on this subject.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="duty-cycle-feedback-with-clipping">
<span id="customize-overmodulation-include-duty-clipping"></span><h4><span class="section-number">6.3.2.8.3. </span>Duty cycle feedback with clipping<a class="headerlink" href="#duty-cycle-feedback-with-clipping" title="Permalink to this heading">¶</a></h4>
<p>Determines whether duty cycle feedback for active estimators is obtained after zero sequence modulation (ZSM) and clipping due to
<a class="reference internal" href="../algorithms/foc/overmodulation.html#algorithm-overmodulation"><span class="std std-ref">overmodulation</span></a>. If not selected, duty cycle feedback will be obtained before ZSM and clipping.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
<section id="an1292-pll">
<h3><span class="section-number">6.3.2.9. </span>AN1292 PLL<a class="headerlink" href="#an1292-pll" title="Permalink to this heading">¶</a></h3>
<p>See the section on <a class="reference internal" href="../algorithms/pll.html#algorithm-pll"><span class="std std-ref">AN1292 Phase-locked Loop (PLL)</span></a> for more information.</p>
<section id="time-constant">
<span id="customize-pll-tau"></span><h4><span class="section-number">6.3.2.9.1. </span>Time constant<a class="headerlink" href="#time-constant" title="Permalink to this heading">¶</a></h4>
<p>Determines the time constant <span class="math notranslate nohighlight">\(\tau\)</span> used for velocity estimation. This does not affect estimator stability,
but it does impact the velocity control loop performance. Lower values of time constant let more noise through,
but allow higher-bandwidth velocity loops. Higher values of time constant filter out more noise,
but reduce the achievable velocity loop bandwidth.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="loop-filter-bandwidth">
<span id="customize-pll-omega1"></span><h4><span class="section-number">6.3.2.9.2. </span>Loop filter bandwidth<a class="headerlink" href="#loop-filter-bandwidth" title="Permalink to this heading">¶</a></h4>
<p>Determines the loop filter bandwidth <span class="math notranslate nohighlight">\(\omega_1\)</span> used for angle estimation in the PLL. (Note: this is a different
value than the startup velocity, also called <span class="math notranslate nohighlight">\(\omega_1\)</span>)</p>
<p>Leaving this value at its default is recommended.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R5.</span></p>
</div>
</section>
<section id="filter-threshold">
<span id="customize-pll-velocity-filter-threshold"></span><h4><span class="section-number">6.3.2.9.3. </span>Filter threshold<a class="headerlink" href="#filter-threshold" title="Permalink to this heading">¶</a></h4>
<p>Determines the maximum velocity for slow filtering in the PLL estimator. Leaving this value at its default is recommended.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
</section>
<section id="quadrature-encoder">
<h3><span class="section-number">6.3.2.10. </span>Quadrature encoder<a class="headerlink" href="#quadrature-encoder" title="Permalink to this heading">¶</a></h3>
<p>See the section on <a class="reference internal" href="../algorithms/qei.html#algorithm-qei"><span class="std std-ref">quadrature encoder support</span></a> for more information.</p>
<section id="lines">
<span id="customize-encoder-lines"></span><h4><span class="section-number">6.3.2.10.1. </span>Lines<a class="headerlink" href="#lines" title="Permalink to this heading">¶</a></h4>
<p>This should match the number of lines, or cycles per revolution (CPR),
listed in the datasheet of the motor or encoder.
The number of counts per revolution is 4× the number of lines.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="index-pulse-present">
<span id="customize-encoder-index-present"></span><h4><span class="section-number">6.3.2.10.2. </span>Index pulse present<a class="headerlink" href="#index-pulse-present" title="Permalink to this heading">¶</a></h4>
<p>Select this option if an index pulse signal is present.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="tracking-loop-time-constant">
<span id="customize-encoder-tracking-loop-tau"></span><h4><span class="section-number">6.3.2.10.3. </span>Tracking loop time constant<a class="headerlink" href="#tracking-loop-time-constant" title="Permalink to this heading">¶</a></h4>
<p>Values in the 1 ms – 10 ms range are recommended.
Smaller values will increase estimator bandwidth
but allow more encoder quantization noise to appear in the
velocity estimate. Larger values will decrease estimator bandwidth,
along with the achievable velocity loop bandwidth, but will
decrease the effect of encoder quantization noise.</p>
<p><strong>Note:</strong> With MCAF R4, out-of-range errors in code generation will occur for certain combinations
of motors with low speed ratings, and choices of tracking loop time constant. This is expected when
<span class="math notranslate nohighlight">\(\omega_{m1} \tau &lt; \theta_L\)</span> where <span class="math notranslate nohighlight">\(\theta_L \approx 0.4\ \text{rad}\)</span>, where <span class="math notranslate nohighlight">\(\omega_{m1}\)</span> is
the rated motor velocity in rad/s, and <span class="math notranslate nohighlight">\(\tau\)</span> is the tracking loop time constant. A viable workaround in
most cases is to increase the tracking loop time constant, though this would reduce the velocity loop bandwidth.</p>
<p>For example, a motor with rated velocity
of 2000 RPM ≈ 209 rad/s
is likely to have out-of-range errors if the tracking loop time constant
is less than approximately <span class="math notranslate nohighlight">\(0.4 / 209 = 0.0019\)</span> s or 1.9 ms.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="synchronization-method">
<span id="customize-encoder-qei-sync-method"></span><h4><span class="section-number">6.3.2.10.4. </span>Synchronization method<a class="headerlink" href="#synchronization-method" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>Align</strong> — best general-purpose synchronization method,
fastest, sensitive to large cogging torque</p></li>
<li><p><strong>Pullout</strong> — most immune to cogging torque, sensitive to high inertia</p></li>
<li><p><strong>Align-and-sweep</strong> — slow, best accuracy</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="customize-encoder-qei-sync-align-t-align">
<span id="id4"></span><h4><span class="section-number">6.3.2.10.5. </span>Align time<a class="headerlink" href="#customize-encoder-qei-sync-align-t-align" title="Permalink to this heading">¶</a></h4>
<p>This determines the align time used for back-emf synchronization.
Systems with larger inertia may need longer times.
Shorter times (less than 0.5 s) may be adequate for very low inertia systems.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="align-angle-shift">
<span id="customize-encoder-qei-sync-align-angle-shift"></span><h4><span class="section-number">6.3.2.10.6. </span>Align angle shift<a class="headerlink" href="#align-angle-shift" title="Permalink to this heading">¶</a></h4>
<p>Increase this angle for systems with high cogging torque.
Values of 30° – 60° are recommended.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="align-initial-angle">
<span id="customize-encoder-qei-sync-align-angle-init"></span><h4><span class="section-number">6.3.2.10.7. </span>Align initial angle<a class="headerlink" href="#align-initial-angle" title="Permalink to this heading">¶</a></h4>
<p>Controls the initial electrical angle used during the rampup state of startup.
Some angles may be slightly more robust, but this must be determined
empirically for a particular motor.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="align-and-sweep-rate">
<span id="customize-encoder-qei-sync-align-sweep-sweep-rate-pow"></span><h4><span class="section-number">6.3.2.10.8. </span>Align-and-sweep rate<a class="headerlink" href="#align-and-sweep-rate" title="Permalink to this heading">¶</a></h4>
<p>4 counts per ISR is the fastest, and is adequate for most motors with low cogging torque.
Decrease this value for motors with high cogging torque.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="align-and-sweep-setup-angle">
<span id="customize-encoder-qei-sync-align-sweep-setup-angle"></span><h4><span class="section-number">6.3.2.10.9. </span>Align-and-sweep setup angle<a class="headerlink" href="#align-and-sweep-setup-angle" title="Permalink to this heading">¶</a></h4>
<p>This controls the setup angle prior to making commutation offset measurements.
Smaller values may not leave enough time for transients to settle.
Larger values will add more time for transients to settle.
Increasing it for high-inertia systems may improve accuracy.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
<section id="pullout-slip-threshold">
<span id="customize-encoder-qei-sync-pullout-pullout-slip"></span><h4><span class="section-number">6.3.2.10.10. </span>Pullout slip threshold<a class="headerlink" href="#pullout-slip-threshold" title="Permalink to this heading">¶</a></h4>
<p>This parameter controls the slip at which pullout offset is measured for determining commutation offset.
Slip here is defined as the rate of change of difference in the angle of the stationary frame voltage vector <span class="math notranslate nohighlight">\(V_{\alpha\beta}\)</span>
and the raw electrical position from the encoder.
Good choices for this parameter depend on the motor’s mechanical properties, namely inertia <span class="math notranslate nohighlight">\(J\)</span>,
viscous damping <span class="math notranslate nohighlight">\(B\)</span>, and friction torque <span class="math notranslate nohighlight">\(T_{fr}\)</span>.
The slip threshold may need to be increased for motors with low inertia, or decreased for motors with higher inertia.
The recommended range for slip threshold is approximately 0.059 to 0.47 rad/s. (0.5× to 4× the default value)</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R4.</span></p>
</div>
</section>
</section>
<section id="dynamic-current-limit">
<span id="customize-dyn-current1-nsamples"></span><span id="customize-dyn-current1-tau"></span><span id="customize-dyn-current1-horizon-factor"></span><span id="customize-dyn-current1-peak-factor"></span><span id="customize-dyn-current1"></span><h3><span class="section-number">6.3.2.11. </span>Dynamic current limit<a class="headerlink" href="#dynamic-current-limit" title="Permalink to this heading">¶</a></h3>
<p>The following parameters control the behavior of the simple dynamic current limit algorithm.
See the section on <a class="reference internal" href="../algorithms/dynlimit-simple.html#algorithm-dynlim-simple"><span class="std std-ref">dynamic current limit</span></a> for more information.</p>
<ul class="simple">
<li><p>Peak current — Determines the absolute peak current <span class="math notranslate nohighlight">\(I_{\mathrm{peak}}\)</span>.</p></li>
<li><p>Horizon current — Determines the horizon current <span class="math notranslate nohighlight">\(I_{\mathrm{horz}}\)</span> used in the simple dynamic current limit algorithm. The current limit relaxes to the horizon current.</p></li>
<li><p>Time constant — Relaxation time constant <span class="math notranslate nohighlight">\(\tau\)</span> that determines how fast the current limit relaxes to the horizon current.</p></li>
<li><p>Decimation ratio — Determines the decimation ratio <span class="math notranslate nohighlight">\(N\)</span> for executing dynamic current limit algorithm every <span class="math notranslate nohighlight">\(N\)</span> samples of the current control loop.</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="voltage-control">
<span id="customize-voltage-outerloop"></span><h3><span class="section-number">6.3.2.12. </span>Voltage control<a class="headerlink" href="#voltage-control" title="Permalink to this heading">¶</a></h3>
<section id="low-pass-filter-time-constant">
<span id="customize-voltage-outerloop-tau-lpf"></span><h4><span class="section-number">6.3.2.12.1. </span>Low-pass filter time constant<a class="headerlink" href="#low-pass-filter-time-constant" title="Permalink to this heading">¶</a></h4>
<p>Time constant <span class="math notranslate nohighlight">\(\tau_{\mathrm{lpf}}\)</span> for the first-order low-pass filter used to attenuate noise from the output of the current
controller <span class="math notranslate nohighlight">\(V_q\)</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="proportional-gain">
<span id="customize-voltage-outerloop-kp"></span><h4><span class="section-number">6.3.2.12.2. </span>Proportional gain<a class="headerlink" href="#proportional-gain" title="Permalink to this heading">¶</a></h4>
<p>Proportional gain <span class="math notranslate nohighlight">\(K_p\)</span> used in the outer loop controller when voltage is the controlled variable. This parameter must
be tuned manually; see the section on <a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">voltage control</span></a> for guidance.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="customize-voltage-outerloop-tau">
<span id="id5"></span><h4><span class="section-number">6.3.2.12.3. </span>Time constant<a class="headerlink" href="#customize-voltage-outerloop-tau" title="Permalink to this heading">¶</a></h4>
<p>Time constant <span class="math notranslate nohighlight">\(\tau\)</span> used in the outer loop controller when voltage is the controlled variable. This parameter sets the <span class="math notranslate nohighlight">\(K_i\)</span>
gain of the voltage controller using <span class="math notranslate nohighlight">\(\tau = K_p/K_i\)</span>. This parameter must be tuned manually; see the section on
<a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">voltage control</span></a> for guidance.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
<section id="motion-control-api">
<span id="customize-mcapi-section"></span><h3><span class="section-number">6.3.2.13. </span>Motion Control API<a class="headerlink" href="#motion-control-api" title="Permalink to this heading">¶</a></h3>
<p>See the section on <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> for more information.</p>
<section id="filter-time-constant-is">
<span id="customize-mcapi-issquaredtau"></span><h4><span class="section-number">6.3.2.13.1. </span>Filter time constant Is<a class="headerlink" href="#filter-time-constant-is" title="Permalink to this heading">¶</a></h4>
<p>Values of the order of 0.1ms – 10ms are recommended.
Higher time constant values reduce noise in the Is signal that is made available through <a class="reference internal" href="../appendix/glossary.html#term-MCAPI"><span class="xref std std-term">MCAPI</span></a> at the cost
of adding some phase delay compared to the sampled value of Is in MCAF.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="filter-time-constant-iq">
<span id="customize-mcapi-iqtau"></span><h4><span class="section-number">6.3.2.13.2. </span>Filter time constant Iq<a class="headerlink" href="#filter-time-constant-iq" title="Permalink to this heading">¶</a></h4>
<p>Values of the order of 0.1ms – 10ms are recommended.
Higher time constant values reduce noise in the Iq signal that is made available through <a class="reference internal" href="../appendix/glossary.html#term-MCAPI"><span class="xref std std-term">MCAPI</span></a> at the cost
of adding some phase delay compared to the sampled value of Iq in MCAF.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="adc-isr-user-functions">
<span id="customize-mcapi-adcisruserfunctions-enable"></span><h4><span class="section-number">6.3.2.13.3. </span>ADC ISR user functions<a class="headerlink" href="#adc-isr-user-functions" title="Permalink to this heading">¶</a></h4>
<p>Determines if the user-defined functions <code class="docutils literal notranslate"><span class="pre">MCAPI_AdcIsrProlog()</span></code> and <code class="docutils literal notranslate"><span class="pre">MCAPI_AdcIsrEpilog()</span></code> are called at the
beginning and end, respectively, of every MCAF ISR. These functions are defined in <code class="docutils literal notranslate"><span class="pre">mcapi.c</span></code> with the “weak”
attribute, and can be redefined by user-written code for purposes such as functional safety.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
<section id="board-service">
<h3><span class="section-number">6.3.2.14. </span>Board service<a class="headerlink" href="#board-service" title="Permalink to this heading">¶</a></h3>
<section id="ui-service-period">
<span id="customize-board-service-uiservicetiming"></span><h4><span class="section-number">6.3.2.14.1. </span>UI service period<a class="headerlink" href="#ui-service-period" title="Permalink to this heading">¶</a></h4>
<p>Determines the rate at which board service ISR tasks get executed. For further information on board service module
please refer to <a class="reference internal" href="../components/hal.html#board-service-module"><span class="std std-ref">board service module</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="button-debounce-time">
<span id="customize-board-service-uibuttondebouncetime"></span><h4><span class="section-number">6.3.2.14.2. </span>Button debounce time<a class="headerlink" href="#button-debounce-time" title="Permalink to this heading">¶</a></h4>
<p>This parameter determines the amount of time a logical high signal needs to stay high until it is registered as a
button press.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
<section id="long-button-press-time">
<span id="customize-board-service-uibuttonlongpresstime"></span><h4><span class="section-number">6.3.2.14.3. </span>Long button press time<a class="headerlink" href="#long-button-press-time" title="Permalink to this heading">¶</a></h4>
<p>The amount of time it takes for a button press to be registered as a long button press. Increasing this value increases
the length of time before a button is recognized as a long button press.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R6.</span></p>
</div>
</section>
</section>
<section id="optional-analog-inputs">
<h3><span class="section-number">6.3.2.15. </span>Optional analog inputs<a class="headerlink" href="#optional-analog-inputs" title="Permalink to this heading">¶</a></h3>
<p>Optional analog inputs, for signals such as phase voltages and absolute reference voltage, are available
for sampling on some boards. The optional analog input selection in the Customize page will be limited by the
selected board.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
<section id="temperature-bridge">
<span id="customize-adc-temp-bridge-params-slewrate"></span><span id="customize-adc-temp-bridge-params-tau-lpf"></span><span id="customize-adc-temp-bridge-params-threshold"></span><span id="customize-adc-vtempbridge"></span><h4><span class="section-number">6.3.2.15.1. </span>Temperature bridge<a class="headerlink" href="#temperature-bridge" title="Permalink to this heading">¶</a></h4>
<p>Analog input for sampling the voltage output of the temperature sensor, if available. The temperature sampled from this
input is used for triggering an overtemperature fault. There are three parameters associated with this analog input:</p>
<ul class="simple">
<li><p>Overtemperature threshold — Determines the temperature at which the overtemperature fault will occur</p></li>
<li><p>Time constant — Low-pass filter time constant for attenuating the temperature signal</p></li>
<li><p>Slew rate — Maximum slew rate of the temperature signal, used for voltage spike rejection</p></li>
</ul>
<p>See the section on <a class="reference internal" href="../algorithms/temperature-measure.html#algorithm-temperature"><span class="std std-ref">temperature measurement</span></a> for more information.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="absolute-voltage-reference">
<span id="customize-adc-vabsref"></span><h4><span class="section-number">6.3.2.15.2. </span>Absolute voltage reference<a class="headerlink" href="#absolute-voltage-reference" title="Permalink to this heading">¶</a></h4>
<p>Analog input for sampling the absolute voltage reference of the board, if available.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
<section id="phase-voltages">
<span id="customize-adc-vphasec"></span><span id="customize-adc-vphaseb"></span><span id="customize-adc-vphasea"></span><h4><span class="section-number">6.3.2.15.3. </span>Phase voltages<a class="headerlink" href="#phase-voltages" title="Permalink to this heading">¶</a></h4>
<p>Analog inputs for sampling the voltages on phases A, B, and C, if available.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version R7.</span></p>
</div>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">6.3. Parameter customization</a><ul>
<li><a class="reference internal" href="#summary">6.3.1. Summary</a></li>
<li><a class="reference internal" href="#detailed-information">6.3.2. Detailed information</a><ul>
<li><a class="reference internal" href="#current-measurement">6.3.2.1. Current measurement</a><ul>
<li><a class="reference internal" href="#single-channel">6.3.2.1.1. Single channel</a><ul>
<li><a class="reference internal" href="#minimum-time-window">6.3.2.1.1.1. Minimum time window</a></li>
<li><a class="reference internal" href="#adc-trigger-delay">6.3.2.1.1.2. ADC trigger delay</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#estimators">6.3.2.2. Estimators</a><ul>
<li><a class="reference internal" href="#primary-estimator">6.3.2.2.1. Primary estimator</a></li>
<li><a class="reference internal" href="#active-estimators">6.3.2.2.2. Active estimators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operating-parameters">6.3.2.3. Operating parameters</a><ul>
<li><a class="reference internal" href="#minimum-velocity">6.3.2.3.1. Minimum velocity</a></li>
<li><a class="reference internal" href="#startup-velocity">6.3.2.3.2. Startup velocity</a></li>
<li><a class="reference internal" href="#maximum-velocity">6.3.2.3.3. Maximum velocity</a></li>
<li><a class="reference internal" href="#full-scale-velocity">6.3.2.3.4. Full-scale velocity</a></li>
<li><a class="reference internal" href="#outer-loop-controller">6.3.2.3.5. Outer loop controller</a></li>
<li><a class="reference internal" href="#saliency-threshold">6.3.2.3.6. Saliency threshold</a></li>
<li><a class="reference internal" href="#slew-rate-max-acceleration-deceleration">6.3.2.3.7. Slew rate (max acceleration/deceleration)</a></li>
<li><a class="reference internal" href="#dynamic-current-limit-type">6.3.2.3.8. Dynamic current limit type</a></li>
<li><a class="reference internal" href="#closed-loop-stopping">6.3.2.3.9. Closed-loop stopping</a><ul>
<li><a class="reference internal" href="#speed-and-time-thresholds">6.3.2.3.9.1. Speed and time thresholds</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coastdown-parameters">6.3.2.3.10. Coastdown parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flux-control">6.3.2.4. Flux control</a><ul>
<li><a class="reference internal" href="#flux-control-method">6.3.2.4.1. Flux control method</a></li>
<li><a class="reference internal" href="#current-limit-boundary-type">6.3.2.4.2. Current limit: Boundary type</a></li>
<li><a class="reference internal" href="#current-limit-idmax">6.3.2.4.3. Current limit: Idmax</a></li>
<li><a class="reference internal" href="#current-limit-iqmax">6.3.2.4.4. Current limit: Iqmax</a></li>
<li><a class="reference internal" href="#flux-weakening-enable">6.3.2.4.5. Flux weakening: enable</a></li>
<li><a class="reference internal" href="#flux-weakening-voltage-limit">6.3.2.4.6. Flux weakening: voltage limit</a></li>
<li><a class="reference internal" href="#mtpa-enable">6.3.2.4.7. MTPA: Enable</a></li>
<li><a class="reference internal" href="#mtpa-display-calculations">6.3.2.4.8. MTPA display calculations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dead-time-compensation">6.3.2.5. Dead-time compensation</a><ul>
<li><a class="reference internal" href="#dead-time-compensation-method">6.3.2.5.1. Dead-time compensation method</a></li>
<li><a class="reference internal" href="#current-linearity-range">6.3.2.5.2. Current linearity range</a></li>
<li><a class="reference internal" href="#forward-gain">6.3.2.5.3. Forward gain</a></li>
<li><a class="reference internal" href="#feedback-gain">6.3.2.5.4. Feedback gain</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fault-detection">6.3.2.6. Fault detection</a><ul>
<li><a class="reference internal" href="#undervoltage-margin">6.3.2.6.1. Undervoltage margin</a></li>
<li><a class="reference internal" href="#overvoltage-margin">6.3.2.6.2. Overvoltage margin</a></li>
<li><a class="reference internal" href="#stall-detect-enable">6.3.2.6.3. Stall detect: enable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#startup">6.3.2.7. Startup</a><ul>
<li><a class="reference internal" href="#startup-current">6.3.2.7.1. Startup current</a></li>
<li><a class="reference internal" href="#rampup-time">6.3.2.7.2. Rampup time</a></li>
<li><a class="reference internal" href="#align-time">6.3.2.7.3. Align time</a></li>
<li><a class="reference internal" href="#min-accel-time">6.3.2.7.4. Min accel time</a></li>
<li><a class="reference internal" href="#customize-startup-torque-scale-accel">6.3.2.7.5. Acceleration <span class="math notranslate nohighlight">\(\alpha_1\)</span></a></li>
<li><a class="reference internal" href="#customize-startup-torque-scale-slow-accel">6.3.2.7.6. Acceleration <span class="math notranslate nohighlight">\(\alpha_0\)</span></a></li>
<li><a class="reference internal" href="#hold-time">6.3.2.7.7. Hold time</a></li>
<li><a class="reference internal" href="#customize-startup-omega0">6.3.2.7.8. Speed threshold <span class="math notranslate nohighlight">\(\omega_0\)</span></a></li>
<li><a class="reference internal" href="#angle-converge-rate">6.3.2.7.9. Angle converge rate</a></li>
<li><a class="reference internal" href="#startup-algorithm">6.3.2.7.10. Startup algorithm</a></li>
<li><a class="reference internal" href="#active-damping-max-amplitude">6.3.2.7.11. Active damping: max amplitude</a></li>
<li><a class="reference internal" href="#active-damping-max-gain">6.3.2.7.12. Active damping: max gain</a></li>
<li><a class="reference internal" href="#active-damping-speed-threshold">6.3.2.7.13. Active damping: speed threshold</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overmodulation">6.3.2.8. Overmodulation</a><ul>
<li><a class="reference internal" href="#d-axis-limit">6.3.2.8.1. D-axis limit</a></li>
<li><a class="reference internal" href="#q-axis-limit">6.3.2.8.2. Q-axis limit</a></li>
<li><a class="reference internal" href="#duty-cycle-feedback-with-clipping">6.3.2.8.3. Duty cycle feedback with clipping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#an1292-pll">6.3.2.9. AN1292 PLL</a><ul>
<li><a class="reference internal" href="#time-constant">6.3.2.9.1. Time constant</a></li>
<li><a class="reference internal" href="#loop-filter-bandwidth">6.3.2.9.2. Loop filter bandwidth</a></li>
<li><a class="reference internal" href="#filter-threshold">6.3.2.9.3. Filter threshold</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quadrature-encoder">6.3.2.10. Quadrature encoder</a><ul>
<li><a class="reference internal" href="#lines">6.3.2.10.1. Lines</a></li>
<li><a class="reference internal" href="#index-pulse-present">6.3.2.10.2. Index pulse present</a></li>
<li><a class="reference internal" href="#tracking-loop-time-constant">6.3.2.10.3. Tracking loop time constant</a></li>
<li><a class="reference internal" href="#synchronization-method">6.3.2.10.4. Synchronization method</a></li>
<li><a class="reference internal" href="#customize-encoder-qei-sync-align-t-align">6.3.2.10.5. Align time</a></li>
<li><a class="reference internal" href="#align-angle-shift">6.3.2.10.6. Align angle shift</a></li>
<li><a class="reference internal" href="#align-initial-angle">6.3.2.10.7. Align initial angle</a></li>
<li><a class="reference internal" href="#align-and-sweep-rate">6.3.2.10.8. Align-and-sweep rate</a></li>
<li><a class="reference internal" href="#align-and-sweep-setup-angle">6.3.2.10.9. Align-and-sweep setup angle</a></li>
<li><a class="reference internal" href="#pullout-slip-threshold">6.3.2.10.10. Pullout slip threshold</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynamic-current-limit">6.3.2.11. Dynamic current limit</a></li>
<li><a class="reference internal" href="#voltage-control">6.3.2.12. Voltage control</a><ul>
<li><a class="reference internal" href="#low-pass-filter-time-constant">6.3.2.12.1. Low-pass filter time constant</a></li>
<li><a class="reference internal" href="#proportional-gain">6.3.2.12.2. Proportional gain</a></li>
<li><a class="reference internal" href="#customize-voltage-outerloop-tau">6.3.2.12.3. Time constant</a></li>
</ul>
</li>
<li><a class="reference internal" href="#motion-control-api">6.3.2.13. Motion Control API</a><ul>
<li><a class="reference internal" href="#filter-time-constant-is">6.3.2.13.1. Filter time constant Is</a></li>
<li><a class="reference internal" href="#filter-time-constant-iq">6.3.2.13.2. Filter time constant Iq</a></li>
<li><a class="reference internal" href="#adc-isr-user-functions">6.3.2.13.3. ADC ISR user functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#board-service">6.3.2.14. Board service</a><ul>
<li><a class="reference internal" href="#ui-service-period">6.3.2.14.1. UI service period</a></li>
<li><a class="reference internal" href="#button-debounce-time">6.3.2.14.2. Button debounce time</a></li>
<li><a class="reference internal" href="#long-button-press-time">6.3.2.14.3. Long button press time</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optional-analog-inputs">6.3.2.15. Optional analog inputs</a><ul>
<li><a class="reference internal" href="#temperature-bridge">6.3.2.15.1. Temperature bridge</a></li>
<li><a class="reference internal" href="#absolute-voltage-reference">6.3.2.15.2. Absolute voltage reference</a></li>
<li><a class="reference internal" href="#phase-voltages">6.3.2.15.3. Phase voltages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="codegen.html"
                          title="previous chapter"><span class="section-number">6.2. </span>Code Generation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="sampling-rate.html"
                          title="next chapter"><span class="section-number">6.4. </span>Sampling Rate and PWM Frequency Implications</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="sampling-rate.html" title="6.4. Sampling Rate and PWM Frequency Implications"
             >next</a> |</li>
        <li class="right" >
          <a href="codegen.html" title="6.2. Code Generation"
             >previous</a> |</li>
    <li><img class="nav-logo"
             src="../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../index.html">MCAF R7 RC37 (docver 7.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">6. </span>General Implementation Issues</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">6.3. </span>Parameter customization</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2023, Microchip Technology, Inc..
    </div>
  </body>
</html>