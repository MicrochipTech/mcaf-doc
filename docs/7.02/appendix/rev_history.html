<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>7.5. Revision History &#8212; MCAF R7 RC37 documentation (docver 7.0.2)</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/microchip.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mcaf_doc.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/contrib/auto-render.min.js"></script>
    <script src="../_static/rendermath.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js"></script>
    <script src="../_static/svgcrop.js"></script>
    <script src="../_static/mcaf-styling.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Frequently Asked Questions (FAQ)" href="../faq.html" />
    <link rel="prev" title="7.4. Related Documents" href="otherdocs.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../faq.html" title="8. Frequently Asked Questions (FAQ)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="otherdocs.html" title="7.4. Related Documents"
             accesskey="P">previous</a> |</li>
    <li><img class="nav-logo"
             src="../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../index.html">MCAF R7 RC37 (docver 7.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><span class="section-number">7. </span>Appendix</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">7.5. </span>Revision History</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="revision-history">
<span id="appendix-revhistory"></span><h1><span class="section-number">7.5. </span>Revision History<a class="headerlink" href="#revision-history" title="Permalink to this heading">¶</a></h1>
<p>This section covers both the revision history for this documentation
and for the MCAF itself.</p>
<section id="mcaf-documentation-revision-history">
<h2><span class="section-number">7.5.1. </span>MCAF Documentation Revision History<a class="headerlink" href="#mcaf-documentation-revision-history" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Revision</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.1</p></td>
<td><p>2016 Sep 29</p></td>
<td><p>Preliminary draft</p></td>
</tr>
<tr class="row-odd"><td><p>0.2</p></td>
<td><p>2016 Nov 8</p></td>
<td><p>Clarifications, glossary, and other minor edits</p></td>
</tr>
<tr class="row-even"><td><p>0.3</p></td>
<td><p>2016 Dec 15</p></td>
<td><p>Edits based on staff review</p></td>
</tr>
<tr class="row-odd"><td><p>1.00</p></td>
<td><p>2017 Feb 7</p></td>
<td><ul class="simple">
<li><p>Added subsection on thread safety</p></li>
<li><p>Corrected <code class="docutils literal notranslate"><span class="pre">MCAF_</span></code> prefix in documentation</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>2.0.1</p></td>
<td><p>2017 Oct 9</p></td>
<td><ul class="simple">
<li><p>Fixed test harness documentation issues</p></li>
<li><p>Corrected block diagram (DC link compensation in wrong
place)</p></li>
<li><p>Added updates for MCAF R2</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>2.0.2</p></td>
<td><p>2018 Jul 2</p></td>
<td><ul class="simple">
<li><p>Corrected <a class="reference internal" href="../architecture/numerics.html#normfactors"><span class="std std-ref">scaling factor</span></a> information</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>3.0.1</p></td>
<td><p>2018 Nov 6</p></td>
<td><p>Updated for MCAF R3</p></td>
</tr>
<tr class="row-odd"><td><p>3.0.2</p></td>
<td><p>2018 Nov 7</p></td>
<td><ul class="simple">
<li><p>Added <a class="reference internal" href="../implementation/codegen.html#impl-codegen"><span class="std std-ref">code generation</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../components/foc.html#foc-pwm-duty"><span class="std std-ref">pwm duty cycle</span></a> section
from existing internal documentation</p></li>
<li><p>Minor edits based on staff review</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>4.0.1</p></td>
<td><p>2019 Jul 15</p></td>
<td><p>Updated for MCAF R4:</p>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../algorithms/qei.html#algorithm-qei"><span class="std std-ref">Quadrature encoder support</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/qei.html#qei-sync"><span class="std std-ref">Back-EMF synchronization</span></a> sections</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/startup.html#algorithm-startup"><span class="std std-ref">Startup</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">Parameter customization</span></a> section</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>5.0.1</p></td>
<td><p>2019 Feb 19</p></td>
<td><p>Updated for MCAF R5:</p>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../algorithms/estimators.html#algorithm-estimators"><span class="std std-ref">Position and Velocity Estimation</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/atpll.html#algorithm-atpll"><span class="std std-ref">Angle-tracking Phase-locked Loop (ATPLL)</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/pll.html#algorithm-pll"><span class="std std-ref">AN1292 Phase-locked Loop (PLL)</span></a> section</p></li>
<li><p>Updated <a class="reference internal" href="../components/hal.html#hal"><span class="std std-ref">HAL</span></a> section to cover ADC timing
and dsPIC33CK support</p></li>
<li><p>Added test harness section on <a class="reference internal" href="../components/testharness.html#test-pause-in-hold"><span class="std std-ref">Pause at end of open-loop startup</span></a></p></li>
<li><p>Updated
<a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">customizable parameters</span></a>
section</p></li>
<li><p>Minor edits based on staff review</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>6.0.1</p></td>
<td><p>2020 Oct 5</p></td>
<td><p>Updated for MCAF R6:</p>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../implementation/sampling-rate.html#impl-sampling-rate"><span class="std std-ref">Sampling Rate and PWM Frequency Implications</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/foc/tuning.html#algorithm-foc-tuning"><span class="std std-ref">Current loop tuning</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API (MCAPI)</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/flux_control/index.html#algorithm-flux-control"><span class="std std-ref">Flux control</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-deadtimecompensation"><span class="std std-ref">Dead-time Compensation</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/foc/fundamentals.html#foc-fundamentals"><span class="std std-ref">introductory section on FOC</span></a></p></li>
<li><p>Rewrote section <a class="reference internal" href="../implementation/integration.html#integration"><span class="std std-ref">Integration with Custom Code</span></a>
to reflect MCAPI</p></li>
<li><p>Updated <a class="reference internal" href="../components/hal.html#hal"><span class="std std-ref">HAL</span></a> section to include the
implication of differences in PWM deadtime behavior
between dsPIC33E and dsPIC33C</p></li>
<li><p>Updated <a class="reference internal" href="../implementation/resource-usage.html#resource-usage-r6"><span class="std std-ref">Usage statistics for MCAF R6</span></a> section</p></li>
<li><p>Updated
<a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">customizable parameters</span></a>
section</p></li>
<li><p>Minor edits based on staff review</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>6.0.2</p></td>
<td><p>2022 Feb 23</p></td>
<td><p>Stylistic changes</p></td>
</tr>
<tr class="row-even"><td><p>7.0.1</p></td>
<td><p>2023 Feb 15</p></td>
<td><p>Updated for MCAF R7:</p>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../algorithms/foc/comparison-6step.html#foc-compare-6step"><span class="std std-ref">Comparison between FOC and six-step control</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-measure"><span class="std std-ref">Current measurement</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/foc/overview.html#foc-overview"><span class="std std-ref">Field-oriented control (FOC): an overview</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/current-limit.html#algorithm-ilimit"><span class="std std-ref">Current limit</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/dynlimit-simple.html#algorithm-dynlim-simple"><span class="std std-ref">Simple dynamic current limit</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/temperature-measure.html#algorithm-temperature"><span class="std std-ref">Temperature measurement</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">Voltage Control</span></a> section</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/zsmt.html#algorithm-zsmt"><span class="std std-ref">Zero-Speed / Maximum Torque (ZS/MT)</span></a> section</p></li>
<li><p>Marked <a class="reference internal" href="../algorithms/qei_sync/pullout.html#qei-sync-pullout"><span class="std std-ref">Pullout torque method</span></a>
as deprecated</p></li>
<li><p>Updated <a class="reference internal" href="../algorithms/estimators.html#algorithm-estimators"><span class="std std-ref">Position and Velocity
Estimation</span></a> section to include
ZS/MT estimator and <a class="reference internal" href="../algorithms/estimator-interface.html#algorithm-estimator-interface"><span class="std std-ref">Firmware Interface</span></a></p></li>
<li><p>Updated <a class="reference internal" href="../algorithms/startup.html#algorithm-startup"><span class="std std-ref">Startup</span></a> section
to include ZS/MT initial position correction
startup method</p></li>
<li><p>Updated <a class="reference internal" href="../components/foc.html#foc"><span class="std std-ref">Field Oriented Control</span></a> section to
describe <a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">voltage loop</span></a></p></li>
<li><p>Updated <a class="reference internal" href="../components/hal.html#hal"><span class="std std-ref">HAL</span></a> section to describe an updated
design of the <a class="reference internal" href="../components/hal.html#board-service-module-bootstrap-charging"><span class="std std-ref">PWM bootstrap charging routine</span></a></p></li>
<li><p>Updated <a class="reference internal" href="../components/main.html#component-main"><span class="std std-ref">Main application</span></a> section
to reflect the changes in the structure of the
main application</p></li>
<li><p>Updated <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> section
to describe the new methods</p></li>
<li><p>Updated <a class="reference internal" href="../components/statemach.html#component-statemachine"><span class="std std-ref">State machine</span></a>
section to document changes in the MCAF state machine</p></li>
<li><p>Updated <a class="reference internal" href="../components/supervisory.html#supervisory"><span class="std std-ref">Supervisory algorithms</span></a> section to describe
<a class="reference internal" href="../components/supervisory.html#supervisory-overtemperature"><span class="std std-ref">overtemperature detection</span></a></p></li>
<li><p>Updated <a class="reference internal" href="../components/testharness.html#test-harness"><span class="std std-ref">Test harness</span></a> section
to describe new features</p></li>
<li><p>Updated <a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">customizable parameters</span></a> section</p></li>
<li><p>Updated <a class="reference internal" href="../implementation/resource-usage.html#resource-usage"><span class="std std-ref">Resource usage</span></a> section</p></li>
<li><p>Updated <a class="reference internal" href="../implementation/integration.html#integration"><span class="std std-ref">Integration with custom
code</span></a> section to reflect changes in
the structure of the <a class="reference internal" href="../components/main.html#component-main-r7"><span class="std std-ref">main application</span></a></p></li>
<li><p>Minor edits based on staff review</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>7.0.2</p></td>
<td><p>2023 Feb 22</p></td>
<td><ul class="simple">
<li><p>Updated <a class="reference internal" href="../components/adc.html#component-adc-calibration"><span class="std std-ref">ADC Calibration and Compensation</span></a> section
to reflect changes in MCAF R7 for single-channel
and triple-channel support</p></li>
<li><p>Minor edits based on staff review</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="mcaf-revision-history">
<h2><span class="section-number">7.5.2. </span>MCAF Revision History<a class="headerlink" href="#mcaf-revision-history" title="Permalink to this heading">¶</a></h2>
<p>In brief:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Revision</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>R1 RC12</p></td>
<td><p>2017 Feb 28</p></td>
<td><p>Initial release as part of motorBench<sup>®</sup> Development Suite 1.15</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#appendix-revhistory-r2rc9"><span class="std std-ref">R2 RC9</span></a></p></td>
<td><p>2017 Sep 29</p></td>
<td><p>Internal release:</p>
<ul class="simple">
<li><p>Added support for overmodulation</p></li>
<li><p>Added support for DC link compensation</p></li>
<li><p>Added support for wider range of low-voltage motors</p></li>
<li><dl class="simple">
<dt><a class="reference internal" href="../architecture/numerics.html#normfactors"><span class="std std-ref">Scaling factors</span></a> updated</dt><dd><ul>
<li><p>All voltages now use scaling factor of maximum ADC
input for the DC link; R1 used <span class="math notranslate nohighlight">\(24V/\sqrt{3}\)</span>
for FOC voltages</p></li>
<li><p>Mechanical velocity now uses 1.5 times maximum
motor velocity; R1 used 30000 electrical RPM</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Updated HAL for future MCHV-2 support</p></li>
<li><p>Updated Motor Control Library</p></li>
<li><p>Numerous minor fixes</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#appendix-revhistory-r3rc14"><span class="std std-ref">R3 RC14</span></a></p></td>
<td><p>2018 Oct 4</p></td>
<td><p>Release intended as part of motorBench<sup>®</sup> Development Suite 2.0</p>
<ul class="simple">
<li><p>Supports use of MCC for system / oscillator module</p></li>
<li><p>Completed support for MCHV-2 HAL</p></li>
<li><p>Other minor fixes</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#appendix-revhistory-r4rc12"><span class="std std-ref">R4 RC12</span></a></p></td>
<td><p>2019 Jun 21</p></td>
<td><p>Release intended as part of motorBench<sup>®</sup> Development Suite 2.15</p>
<ul class="simple">
<li><p><a class="reference internal" href="../components/hal.html#hal-mcaf-r4"><span class="std std-ref">MCC peripheral support</span></a></p></li>
<li><p><a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">Parameter customization</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/qei.html#algorithm-qei"><span class="std std-ref">Quadrature encoder support</span></a></p></li>
<li><p>Added new startup method (<a class="reference internal" href="../algorithms/startup.html#startup-weathervane"><span class="std std-ref">Weathervane startup</span></a>)</p></li>
<li><p>Other minor fixes</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#appendix-revhistory-r5rc11"><span class="std std-ref">R5 RC11</span></a></p></td>
<td><p>2020 Feb 7</p></td>
<td><p>Release intended as part of motorBench<sup>®</sup> Development Suite 2.25</p>
<ul class="simple">
<li><p><a class="reference internal" href="../components/hal.html#hal-mcaf-r5"><span class="std std-ref">dsPIC33CK support</span></a></p></li>
<li><p><a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">Customize page improvements</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/atpll.html#algorithm-atpll"><span class="std std-ref">Angle-tracking Phase-locked Loop (ATPLL)</span></a></p></li>
<li><p>Other minor fixes and improvements</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#appendix-revhistory-r6rc8"><span class="std std-ref">R6 RC8</span></a></p></td>
<td><p>2020 Aug 25</p></td>
<td><p>Release intended as part of motorBench<sup>®</sup> Development Suite 2.35</p>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../components/hal.html#hal-mcaf-r6"><span class="std std-ref">device support for new devices in
dsPIC33CK series</span></a>
(dsPIC33CK64MC105, dsPIC33CK64MP105)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">flux_control</span></code> module with support for
<a class="reference internal" href="../algorithms/flux_control/flux_weakening.html#algorithm-flux-weakening"><span class="std std-ref">flux weakening</span></a> (FW) and <a class="reference internal" href="../algorithms/flux_control/mtpa.html#algorithm-mtpa"><span class="std std-ref">maximum torque per ampere</span></a>
(MTPA)</p></li>
<li><p>Added <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> (MCAPI)</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-deadtimecompensation"><span class="std std-ref">dead-time compensation</span></a></p></li>
<li><p>Redesigned <a class="reference internal" href="../components/hal.html#board-service-module"><span class="std std-ref">board service module</span></a></p></li>
<li><p>Other minor fixes and improvements</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#appendix-revhistory-r7rc37"><span class="std std-ref">R7 RC37</span></a></p></td>
<td><p>2023 Feb 9</p></td>
<td><p>Release intended as part of motorBench<sup>®</sup> Development Suite 2.45</p>
<ul class="simple">
<li><p>Added support for <a class="reference external" href="https://www.microchip.com/en-us/tools-resources/configure/mplab-code-configurator/melody">MCC Melody</a></p></li>
<li><dl class="simple">
<dt>Added several new features:</dt><dd><ul>
<li><p><a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-single-channel"><span class="std std-ref">Single-channel</span></a> measurement (“single-shunt”)</p></li>
<li><p><a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-triple-channel"><span class="std std-ref">Triple-channel</span></a> measurement  (“triple-shunt”)</p></li>
<li><p><a class="reference internal" href="../algorithms/zsmt.html#algorithm-zsmt"><span class="std std-ref">Zero-Speed / Maximum Torque (ZS/MT)</span></a> estimator</p></li>
<li><p><a class="reference internal" href="../algorithms/dynlimit-simple.html#algorithm-dynlim-simple"><span class="std std-ref">Dynamic current limiting</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">Voltage outer loop control</span></a></p></li>
<li><p><a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping-closed-loop"><span class="std std-ref">Closed-loop stopping methods</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Added new methods for <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> (MCAPI)</p></li>
<li><p>Restructured the <a class="reference internal" href="../components/main.html#sample-application"><span class="std std-ref">sample application</span></a> and <code class="docutils literal notranslate"><span class="pre">mcaf_main</span></code> module</p></li>
<li><p>Added support for internal op-amps</p></li>
<li><dl class="simple">
<dt>Added support for new development boards</dt><dd><ul>
<li><p><a class="reference external" href="https://www.microchip.com/en-us/development-tool/DM330031">dsPIC33CK Low Voltage Motor Control (LVMC) Development Board</a></p></li>
<li><p><a class="reference external" href="https://www.microchip.com/en-us/development-tool/EV18H47A">MCS MCLV‑48V‑300W Development Board</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Other minor fixes and improvements</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>In detail:</p>
<section id="mcaf-r2-rc9">
<span id="appendix-revhistory-r2rc9"></span><h3><span class="section-number">7.5.2.1. </span>MCAF R2 RC9<a class="headerlink" href="#mcaf-r2-rc9" title="Permalink to this heading">¶</a></h3>
<section id="modules-added-removed">
<h4><span class="section-number">7.5.2.1.1. </span>Modules added/removed<a class="headerlink" href="#modules-added-removed" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">atan2cordic</span></code> was removed (not required by any other modules)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">board_service</span></code>, <code class="docutils literal notranslate"><span class="pre">filter</span></code>, and <code class="docutils literal notranslate"><span class="pre">units</span></code> added</p></li>
</ul>
</section>
<section id="core-foc">
<h4><span class="section-number">7.5.2.1.2. </span>Core FOC<a class="headerlink" href="#core-foc" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>The inverse Clarke transform has been replaced by its conventional
variant. (MCAF R1 had swapped <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>)</p></li>
<li><p>Space vector modulation with phase-shifted inputs has been replaced
by an implementation of <a class="reference internal" href="../components/foc.html#foc-zsm"><span class="std std-ref">zero-sequence modulation</span></a> that includes
clipping in order to implement <a class="reference internal" href="../algorithms/foc/overmodulation.html#algorithm-overmodulation"><span class="std std-ref">overmodulation</span></a>.</p></li>
</ul>
</section>
<section id="overmodulation">
<h4><span class="section-number">7.5.2.1.3. </span>Overmodulation<a class="headerlink" href="#overmodulation" title="Permalink to this heading">¶</a></h4>
<p><a class="reference internal" href="../algorithms/foc/overmodulation.html#algorithm-overmodulation"><span class="std std-ref">Overmodulation</span></a> support has been added.</p>
</section>
<section id="dc-link-compensation">
<h4><span class="section-number">7.5.2.1.4. </span>DC link compensation<a class="headerlink" href="#dc-link-compensation" title="Permalink to this heading">¶</a></h4>
<p><a class="reference internal" href="../algorithms/foc/dclink-comp.html#algorithm-dclinkcompensation"><span class="std std-ref">DC link compensation</span></a> support has been added.</p>
</section>
<section id="expanded-range-of-supported-motors">
<h4><span class="section-number">7.5.2.1.5. </span>Expanded range of supported motors<a class="headerlink" href="#expanded-range-of-supported-motors" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Parameter generation tested under a wide range of motor parameters
to identify and correct range issues.</p></li>
<li><p>Several shift counts changed to be selected at code generation
time (rather than a fixed Q15).</p></li>
<li><p>Several time delay values (mostly in startup and stall detection)
changed to utilize 32-bit counts, so that longer time constants
can be supported.</p></li>
<li><p>Some of the PLL calculations were rewritten to prevent overflow.</p></li>
</ul>
</section>
<section id="scaling-factors-and-operating-range">
<h4><span class="section-number">7.5.2.1.6. </span>Scaling factors and operating range<a class="headerlink" href="#scaling-factors-and-operating-range" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>The scaling factors for voltages have been unified to one value
based on maximum DC link voltage.</p></li>
<li><p>The scaling factor for motor velocity has been changed
to be 1.5 times the base speed of the motor; the capability has
been added in MCAF to override this from motorBench<sup>®</sup> Development Suite, although as of
motorBench<sup>®</sup> Development Suite revision 1.35 this is not yet possible.</p></li>
<li><p>Minimum operating speed is now set based on the minimum
electrical frequency selected in motorBench<sup>®</sup> Development Suite.</p></li>
</ul>
</section>
<section id="fault-detection">
<h4><span class="section-number">7.5.2.1.7. </span>Fault detection<a class="headerlink" href="#fault-detection" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>The torque angle method of stall detection was rewritten
to improve accuracy over a wider range of motors.</p></li>
<li><p>The Ed method of stall detection was adjusted to remove
low-pass filtering that was hindering stall detection with some motors.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">monitor</span></code> module was rewritten as a simple state machine
to avoid unintentional behavior.</p></li>
</ul>
</section>
<section id="test-harness">
<h4><span class="section-number">7.5.2.1.8. </span>Test Harness<a class="headerlink" href="#test-harness" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added ability to <a class="reference internal" href="../components/testharness.html#test-state-change"><span class="std std-ref">force state change</span></a>
(e.g. <code class="docutils literal notranslate"><span class="pre">STOPPING</span></code> → <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code> )</p></li>
</ul>
</section>
<section id="hal">
<h4><span class="section-number">7.5.2.1.9. </span>HAL<a class="headerlink" href="#hal" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added new interfaces for <code class="docutils literal notranslate"><span class="pre">TMR1</span></code> (hardware timer 1)</p></li>
<li><p>Added additional functions for <code class="docutils literal notranslate"><span class="pre">UART1</span></code></p></li>
<li><p>Refactored some of the Application Interfaces in BSP, moved LED and test-point related interfaces to HAF</p></li>
<li><p>Added a new <a class="reference internal" href="../components/hal.html#board-service-module"><span class="std std-ref">board service module</span></a></p></li>
</ul>
</section>
<section id="motor-control-library">
<h4><span class="section-number">7.5.2.1.10. </span>Motor Control Library<a class="headerlink" href="#motor-control-library" title="Permalink to this heading">¶</a></h4>
<p>The version of the Motor Control Library included with MCAF R2
has added a number of new functions, including zero sequence modulation
with clipping, and the conventional Inverse Clarke transform.</p>
<p>Please do not use this version of the Motor Control Library in other
projects outside the MCAF.</p>
</section>
<section id="miscellaneous">
<h4><span class="section-number">7.5.2.1.11. </span>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this heading">¶</a></h4>
<p>MCAF version information (“R2/RC9” along with a commit id
and build date) has been added to all C source files outside
of the libraries.</p>
</section>
</section>
<section id="mcaf-r3-rc14">
<span id="appendix-revhistory-r3rc14"></span><h3><span class="section-number">7.5.2.2. </span>MCAF R3 RC14<a class="headerlink" href="#mcaf-r3-rc14" title="Permalink to this heading">¶</a></h3>
<p>Note to the reader: starting with this release, you may see issue tracker keys listed in the revision history in parentheses,
such as DB_MC-97. These are present to assist Microchip staff in referring to more detailed information as necessary.</p>
<section id="id1">
<h4><span class="section-number">7.5.2.2.1. </span>Modules added/removed<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">meas_curr</span></code> module, written in assembly, has been combined with some functionality
of the <code class="docutils literal notranslate"><span class="pre">foc</span></code> module to form a new <code class="docutils literal notranslate"><span class="pre">adc_compensation</span></code> module written in C. (DB_MC-97, DB_MC-675)</p>
</section>
<section id="mcc-compatibility">
<span id="revhistory-r3-mcc"></span><h4><span class="section-number">7.5.2.2.2. </span>MCC compatibility<a class="headerlink" href="#mcc-compatibility" title="Permalink to this heading">¶</a></h4>
<p>MCAF is now compatible with the MCC system module including oscillator setup. (DB_MC-1679,
DB_MC-1688, DB_MC-1689, DB_MC-1690)</p>
<ul class="simple">
<li><p>The former <code class="docutils literal notranslate"><span class="pre">traps</span></code> and <code class="docutils literal notranslate"><span class="pre">main</span></code> modules of MCAF have been renamed <code class="docutils literal notranslate"><span class="pre">mcaf_traps</span></code> and <code class="docutils literal notranslate"><span class="pre">mcaf_main</span></code>.
(DB_MC-1685, DB_MC-1686)</p></li>
<li><p>There is now an mcaf_main.h as well to include function declarations. (DB_MC-1846)</p></li>
<li><p>MCAF is no longer responsible for producing <code class="docutils literal notranslate"><span class="pre">main()</span></code>; instead, the MCC <code class="docutils literal notranslate"><span class="pre">main()</span></code> function
now calls into MCAF for initialization and the main loop.</p></li>
<li><p>MCAF has yielded responsibility to MCC for generating configuration bits</p></li>
<li><p>MCAF has yielded responsibility to MCC for oscillator configuration (DB_MC-1849)</p></li>
<li><p>Some functions in the HAL have been renamed with an <code class="docutils literal notranslate"><span class="pre">MCAF_</span></code> prefix to avoid name conflicts with
MCC-generated HAL functions.</p></li>
</ul>
<p>MCAF is still not compatible with other modules from MCC, including the ADC, UART, and PWM.
The HAL within MCAF takes responsibility for configuring and using these modules.</p>
<p>See the documentation for the <a class="reference internal" href="../components/hal.html#hal-mcaf-r3"><span class="std std-ref">HAL</span></a> for more information.</p>
</section>
<section id="mchv-2-and-mchv-3-compatibility">
<h4><span class="section-number">7.5.2.2.3. </span>MCHV-2 and MCHV-3 compatibility<a class="headerlink" href="#mchv-2-and-mchv-3-compatibility" title="Permalink to this heading">¶</a></h4>
<p>The HAL generated by MCAF is now fully compatible with the MCHV-2 and MCHV-3 development boards.
(MCAF R2 did contain the required HAL functions for MCHV-2/MCHV-3 but always generated code for MCLV-2.)</p>
</section>
<section id="id2">
<h4><span class="section-number">7.5.2.2.4. </span>Scaling factors and operating range<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h4>
<p>The continuous rated inverter current as entered in motorBench<sup>®</sup> Development Suite is now exactly equal to the maximum dq-frame
commanded current amplitude. In MCAF R2, there was a 0.824 derating factor applied. (DB_MC-1307)</p>
</section>
<section id="adc-compensation">
<h4><span class="section-number">7.5.2.2.5. </span>ADC compensation<a class="headerlink" href="#adc-compensation" title="Permalink to this heading">¶</a></h4>
<p>The ADC current gain matrix is now generated dynamically. In MCAF R2 it was fixed to support unmodified
MCLV-2 boards. It now can handle arbitrary gains setup in motorBench<sup>®</sup> Development Suite. (DB_MC-1332)</p>
</section>
<section id="id3">
<h4><span class="section-number">7.5.2.2.6. </span>Core FOC<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>PLL now uses <code class="docutils literal notranslate"><span class="pre">motor.valphabetaOut</span></code> rather than <code class="docutils literal notranslate"><span class="pre">motor.valphabeta</span></code>. (DB_MC-1164)
The difference between these state variables is that <code class="docutils literal notranslate"><span class="pre">motor.valphabeta</span></code> represents the
intended value of <span class="math notranslate nohighlight">\(V_{\alpha\beta}\)</span> prior to <a class="reference internal" href="../components/foc.html#foc-zsm"><span class="std std-ref">zero-sequence modulation</span></a>, whereas
<code class="docutils literal notranslate"><span class="pre">motor.valphabetaOut</span></code> represents the best estimate of the actual <span class="math notranslate nohighlight">\(V_{\alpha\beta}\)</span>
based on calculating from PWM duty cycles. The two are identical except when the current controller
enters into <a class="reference internal" href="../algorithms/foc/overmodulation.html#algorithm-overmodulation"><span class="std std-ref">overmodulation</span></a>. See also <code class="docutils literal notranslate"><span class="pre">MCAF_ComputeVAlphaBetaAtOutput()</span></code>.</p></li>
</ul>
</section>
<section id="id4">
<h4><span class="section-number">7.5.2.2.7. </span>Fault detection<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Torque angle stall detection has been disabled by default. (DB_MC-1732)
See <a class="reference internal" href="../components/supervisory.html#supervisory-errata"><span class="std std-ref">supervisory errata</span></a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MCAF_VarianceDetectx16Decimate()</span></code> has been renamed <code class="docutils literal notranslate"><span class="pre">MCAF_VarianceDetectx16PostDecimation()</span></code>
for clarity. (DB_MC-846)</p></li>
</ul>
</section>
<section id="id5">
<h4><span class="section-number">7.5.2.2.8. </span>Test Harness<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added ability to <a class="reference internal" href="../components/testharness.html#test-stack-overflow"><span class="std std-ref">cause stack overflow</span></a>. (DB_MC-1708)</p></li>
<li><p>Added <a class="reference internal" href="../components/testharness.html#test-commutation-onoff"><span class="std std-ref">delay loop for commutation overrides</span></a>. (DB_MC-1280)</p></li>
<li><p>DC link compensation can be disabled by setting the corresponding override bit. (DB_MC-1168)</p></li>
</ul>
</section>
<section id="id6">
<h4><span class="section-number">7.5.2.2.9. </span>HAL<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added additional functions for the QEI and PWM modules</p></li>
<li><p>Removed configuration bits and oscillator initialization</p></li>
<li><p>Renamed functions in <code class="docutils literal notranslate"><span class="pre">pin_manager</span></code>, <code class="docutils literal notranslate"><span class="pre">interrupt_manager</span></code>, and <code class="docutils literal notranslate"><span class="pre">mcc</span></code> modules with <code class="docutils literal notranslate"><span class="pre">MCAF_</span></code> prefix
to avoid name conflicts with MCC-generated HAL functions.</p></li>
</ul>
</section>
<section id="id7">
<h4><span class="section-number">7.5.2.2.10. </span>Motor Control Library<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h4>
<p>A minor error in the inline assembly in <code class="docutils literal notranslate"><span class="pre">MC_adjust_zero_sequence</span></code> has been fixed. (DB_MC-1403)
This manifested as a build failure (<code class="docutils literal notranslate"><span class="pre">Error:</span> <span class="pre">Invalid</span> <span class="pre">operands</span> <span class="pre">specified</span> <span class="pre">('add</span> <span class="pre">w0,[w15-10],w8').</span></code>) when
building with <code class="docutils literal notranslate"><span class="pre">-O0</span></code>; as a reminder, please note that MCAF requires optimization level <code class="docutils literal notranslate"><span class="pre">-O1</span></code> or higher
to meet timing constraints.</p>
<p>No other changes have been made.</p>
<p>Updated documentation for the MC Library is not yet available.</p>
<p>Please do not use this version of the Motor Control Library in other
projects outside the MCAF.</p>
</section>
<section id="code-generation">
<h4><span class="section-number">7.5.2.2.11. </span>Code generation<a class="headerlink" href="#code-generation" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Improved code generation error messages when an out-of-range error is encountered. (DB_MC-1435)</p></li>
<li><p>Improved internal mechanisms for calculating parameters in code generation. (DB_MC-1706, DB_MC-1760)</p></li>
<li><p>Overvoltage and undervoltage margins are now set to 2V for MCLV-2 and 20V for MCHV-2. (DB_MC-1734)
Future versions of motorBench<sup>®</sup> Development Suite will allow these values to be edited.</p></li>
</ul>
</section>
<section id="auxiliary-reports">
<h4><span class="section-number">7.5.2.2.12. </span>Auxiliary reports<a class="headerlink" href="#auxiliary-reports" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>The list of derived parameters in aux-files/report.html has been expanded. (DB_MC-1178)</p></li>
<li><p>Reports in aux-files/ now include traceability to the corresponding MCAF version. (DB_MC-1364)</p></li>
<li><p>Updated KaTeX to a more recent version. (DB_MC-1517)</p></li>
<li><p>Fixed a bug in report.xml, specifically a missing close tag (DB_MC-1572)</p></li>
<li><p>The file report.xml has been renamed report.xml.txt to avoid triggering an error in MCC. (DB_MC-1868)</p></li>
</ul>
</section>
<section id="id8">
<h4><span class="section-number">7.5.2.2.13. </span>Miscellaneous<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>MCAF version information has been updated to “R3/RC14”.</p></li>
<li><p>MCAF copyright date updated to 2018. (DB_MC-1788)</p></li>
<li><p>Types header files have been pulled out of the <code class="docutils literal notranslate"><span class="pre">ui</span></code> and <code class="docutils literal notranslate"><span class="pre">startup</span></code> modules – there is now
a <code class="docutils literal notranslate"><span class="pre">ui_types.h</span></code> and <code class="docutils literal notranslate"><span class="pre">startup_types.h</span></code>. (DB_MC-470)</p></li>
<li><p>Certain state variables have been updated from <code class="docutils literal notranslate"><span class="pre">int16_t</span></code> to an appropriate units typedef such as
<code class="docutils literal notranslate"><span class="pre">MCAF_U_VELOCITY</span></code>, <code class="docutils literal notranslate"><span class="pre">MCAF_U_VOLTAGE_ALPHABETA</span></code>, <code class="docutils literal notranslate"><span class="pre">MCAF_U_DIMENSIONLESS_SINCOS</span></code>, etc. (DB_MC-1199, DB_MC-1281)</p></li>
<li><p>Removed unused <code class="docutils literal notranslate"><span class="pre">FindLeadingOne()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">util</span></code> module. (DB_MC-1169)</p></li>
<li><p>Unused <code class="docutils literal notranslate"><span class="pre">MINSPEEDINRPM</span></code> removed. (DB_MC-808)</p></li>
</ul>
</section>
</section>
<section id="mcaf-r4-rc12">
<span id="appendix-revhistory-r4rc12"></span><h3><span class="section-number">7.5.2.3. </span>MCAF R4 RC12<a class="headerlink" href="#mcaf-r4-rc12" title="Permalink to this heading">¶</a></h3>
<section id="id9">
<h4><span class="section-number">7.5.2.3.1. </span>Modules added/removed<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">commutation/qei_sync</span></code> module has been added for <a class="reference internal" href="../algorithms/qei.html#qei-sync"><span class="std std-ref">Back-EMF synchronization</span></a></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pll</span></code> module has been moved to <code class="docutils literal notranslate"><span class="pre">commutation/pll</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">qei</span></code> module has been moved to <code class="docutils literal notranslate"><span class="pre">commutation/qei</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">watchdog</span></code> module has been temporarily renamed <code class="docutils literal notranslate"><span class="pre">mcaf_watchdog</span></code> until a conflict with MCC can be resolved. (DB_MC-2175)</p></li>
</ul>
</section>
<section id="revhistory-r4-mcc">
<span id="id10"></span><h4><span class="section-number">7.5.2.3.2. </span>MCC compatibility<a class="headerlink" href="#revhistory-r4-mcc" title="Permalink to this heading">¶</a></h4>
<p>MCAF peripheral and system initialization code generation is completely handled by MCC.
The only exception to this is the <a class="reference internal" href="glossary.html#term-QEI"><span class="xref std std-term">QEI</span></a> peripheral as this is not supported by MCC yet. (DB_MC-2146)</p>
<ul class="simple">
<li><p>HAF functions have been added to use new MCC PWM APIs. (DB_MC-2089)</p></li>
<li><p>HAF function for retrieving interrupt vector number has been added.</p></li>
</ul>
<p>See the documentation for the <a class="reference internal" href="../components/hal.html#hal-mcaf-r4"><span class="std std-ref">HAL</span></a> for more information.</p>
</section>
<section id="quadrature-encoder-support">
<h4><span class="section-number">7.5.2.3.3. </span>Quadrature encoder support<a class="headerlink" href="#quadrature-encoder-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Support quadrature encoders as a primary position and velocity estimator (DB_MC-812)</p></li>
<li><p>Velocity estimated from the <a class="reference internal" href="glossary.html#term-QEI"><span class="xref std std-term">QEI</span></a>, for use by the velocity control loop, has been corrected to use
the filtered velocity <span class="math notranslate nohighlight">\(\hat\omega_{LPF}\)</span> rather than the unfiltered velocity <span class="math notranslate nohighlight">\(\hat\omega\)</span>.
(DB_MC-2254)</p></li>
<li><p>Added <a class="reference internal" href="glossary.html#term-QEI"><span class="xref std std-term">QEI</span></a> index capture support (DB_MC-2078)</p></li>
</ul>
</section>
<section id="parameter-customization-support">
<h4><span class="section-number">7.5.2.3.4. </span>Parameter customization support<a class="headerlink" href="#parameter-customization-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added ability to adjust key MCAF parameters within the motorBench<sup>®</sup> Development Suite user interface. (DB_MC-2156, DB_MC-2057)</p></li>
</ul>
</section>
<section id="startup">
<h4><span class="section-number">7.5.2.3.5. </span>Startup<a class="headerlink" href="#startup" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added “weathervane” startup method (DB_MC-1039)</p></li>
<li><p>Fixed bug where startup state machine was initialized to <code class="docutils literal notranslate"><span class="pre">SSM_COMPLETE</span></code> state at device reset (DB_MC-2094)</p></li>
</ul>
</section>
<section id="id11">
<h4><span class="section-number">7.5.2.3.6. </span>Core FOC<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Refactored commutation module to support multiple estimators (DB_MC-2076)</p></li>
</ul>
</section>
<section id="id12">
<h4><span class="section-number">7.5.2.3.7. </span>Code generation<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Fixed error in startup hold time calculation so that 32-bit values are now supported (DB_MC-2120)</p></li>
</ul>
</section>
<section id="id13">
<h4><span class="section-number">7.5.2.3.8. </span>Test Harness<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added ability to <a class="reference internal" href="../components/testharness.html#test-commutation-onoff"><span class="std std-ref">control slew rates with slow commutation steps</span></a> (DB_MC-2113)</p></li>
<li><p>Corrected state initialization when entering a test mode (DB_MC-2107)</p></li>
<li><p>Fixed uninitialized <code class="docutils literal notranslate"><span class="pre">overrideCommutationDelay</span></code> (DB_MC-1918)</p></li>
</ul>
</section>
<section id="style-and-readability">
<h4><span class="section-number">7.5.2.3.9. </span>Style and readability<a class="headerlink" href="#style-and-readability" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Startup currents in the <code class="docutils literal notranslate"><span class="pre">startup_params</span></code> module have been renamed for clarify (DB_MC-2227):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">INITIALTORQUE</span></code> → <code class="docutils literal notranslate"><span class="pre">MCAF_STARTUP_CURRENT_INITIAL</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FINALTORQUE</span></code> → <code class="docutils literal notranslate"><span class="pre">MCAF_STARTUP_CURRENT</span></code></p></li>
</ul>
</li>
<li><p>Updated util.h to add assembly comments to inline assembly, for traceability (DB_MC-2011)</p></li>
<li><p>Consistency in MCAF identifier naming:</p>
<ul>
<li><p>Estimator types changed to <code class="docutils literal notranslate"><span class="pre">MCAF_ESTIMATOR_XYZ_T</span></code> from <code class="docutils literal notranslate"><span class="pre">MCAF_XYZ_ESTIMATOR_T</span></code> (DB_MC-2091)</p></li>
<li><p>Estimator functions changed to <code class="docutils literal notranslate"><span class="pre">MCAF_EstimatorXYZStep()</span></code> from <code class="docutils literal notranslate"><span class="pre">MCAF_XYZEstimatorStep()</span></code> (DB_MC-2093)</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="mcaf-r5-rc11">
<span id="appendix-revhistory-r5rc11"></span><h3><span class="section-number">7.5.2.4. </span>MCAF R5 RC11<a class="headerlink" href="#mcaf-r5-rc11" title="Permalink to this heading">¶</a></h3>
<section id="id14">
<h4><span class="section-number">7.5.2.4.1. </span>Modules added/removed<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">commutation/atpll</span></code> module has been added for <a class="reference internal" href="../algorithms/atpll.html#algorithm-atpll"><span class="std std-ref">Angle-tracking Phase-locked Loop (ATPLL)</span></a></p></li>
</ul>
</section>
<section id="mcc-compatibility-and-dspic33ck-support">
<span id="revhistory-r5-mcc"></span><h4><span class="section-number">7.5.2.4.2. </span>MCC compatibility and dsPIC33CK support<a class="headerlink" href="#mcc-compatibility-and-dspic33ck-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>MCAF R5 now supports dsPIC33CK devices. (DB_MC-2399)
See the documentation for the <a class="reference internal" href="../components/hal.html#hal-mcaf-r5"><span class="std std-ref">HAL</span></a> for more information.</p></li>
</ul>
</section>
<section id="id15">
<h4><span class="section-number">7.5.2.4.3. </span>HAL<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Moved <code class="docutils literal notranslate"><span class="pre">FCY</span></code> definition out of ui.c and into HAL (DB_MC-436);
utilized MCC-generated value to reflect actual choice of
oscillator frequency (DB_MC-821)</p></li>
<li><p>Improved proper encapsulation of device-specific issues
through Hardware Access Functions layer (DB_MC-2368)</p></li>
<li><p>Other miscellaneous improvements – see <a class="reference internal" href="../components/hal.html#hal-mcaf-r5"><span class="std std-ref">HAL</span></a> for more information.</p></li>
</ul>
</section>
<section id="diagnostics">
<h4><span class="section-number">7.5.2.4.4. </span>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Updated X2CScope library</p>
<ul>
<li><p>Added dsPIC33CK support. (DB_MC-2420)</p></li>
<li><p>Now allows application to specify buffer (DB_MC-801)</p></li>
<li><p>Recompiled with <code class="docutils literal notranslate"><span class="pre">-O3</span></code> (DB_MC-804)</p></li>
</ul>
</li>
</ul>
</section>
<section id="id16">
<h4><span class="section-number">7.5.2.4.5. </span>Quadrature encoder support<a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Improve parameter management of pullout synchronization method
(DB_MC-2255)</p></li>
<li><p>Clarified and corrected angle units in QEI tracking loop (DB_MC-2521)</p></li>
</ul>
</section>
<section id="atpll-support">
<h4><span class="section-number">7.5.2.4.6. </span>ATPLL support<a class="headerlink" href="#atpll-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../algorithms/atpll.html#algorithm-atpll"><span class="std std-ref">angle-tracking PLL</span></a> (ATPLL) sensorless estimator. (DB_MC-1547)</p></li>
</ul>
</section>
<section id="miscellaneous-sensorless-estimator-issues">
<h4><span class="section-number">7.5.2.4.7. </span>Miscellaneous sensorless estimator issues<a class="headerlink" href="#miscellaneous-sensorless-estimator-issues" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Categorized ATPLL and PLL estimator state variables
to help distinguish core algorithm state from
auxiliary state used for logging (DB_MC-2579, DB_MC-2580)</p></li>
<li><p>Clarified ATPLL and PLL inductance identifiers and units (DB_MC-2601)</p></li>
<li><p>Fixed issue involving estimator initialization, and provided initialization hooks for all sensorless estimators (DB_MC-2576)</p></li>
</ul>
</section>
<section id="id17">
<h4><span class="section-number">7.5.2.4.8. </span>Startup<a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Improved naming of <code class="docutils literal notranslate"><span class="pre">STARTUP_THETA_ERROR_STEP</span></code> to <code class="docutils literal notranslate"><span class="pre">STARTUP_THETA_ERROR_CONVERGE_RATE</span></code> (DB_MC-2388)</p></li>
<li><p>Improve support for slower transitions to closed-loop in Classic startup (DB_MC-2513)</p></li>
<li><p>Fixed small residual <code class="docutils literal notranslate"><span class="pre">thetaError</span></code> values in Classic startup (DB_MC-2529)</p></li>
<li><p>Fixed proper assignment of <code class="docutils literal notranslate"><span class="pre">thetaError</span></code> in Weathervane startup (DB_MC-2628)</p></li>
<li><p>Fixed initialization of startup counter in Weathervane startup (DB_MC-2535)</p></li>
<li><p>Allow nonzero ALIGN time (DB_MC-2510)</p></li>
</ul>
</section>
<section id="id18">
<h4><span class="section-number">7.5.2.4.9. </span>Test Harness<a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Corrected units of <code class="docutils literal notranslate"><span class="pre">overrideOmegaElectrical</span></code> (DB_MC-2543)</p></li>
<li><p>Added feature to allow
<a class="reference internal" href="../components/testharness.html#test-pause-in-hold"><span class="std std-ref">open-loop mode in test harness after normal startup</span></a> (DB_MC-1527)</p></li>
</ul>
</section>
<section id="mb-customize-page-support">
<h4><span class="section-number">7.5.2.4.10. </span>motorBench<sup>®</sup> Development Suite Customize page support<a class="headerlink" href="#mb-customize-page-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>MCAF firmware package can now specify transfer functions
used for autotuning in motorBench<sup>®</sup> Development Suite. (DB_MC-2424)</p></li>
<li><p>Added “Advice” pane for guidance based on motor and system parameters. (DB_MC-2507)</p></li>
<li><p>Added display of normalized values in engineering units. (DB_MC-2519)</p></li>
<li><p>Included additional <a class="reference internal" href="../implementation/ui-customization.html#impl-customization"><span class="std std-ref">customizable parameters</span></a>. (DB_MC-2351)</p></li>
<li><p>Support migration of existing data from previous version of motorBench<sup>®</sup> Development Suite. (DB_MC-2650)</p></li>
</ul>
</section>
<section id="id19">
<h4><span class="section-number">7.5.2.4.11. </span>Motor Control Library<a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h4>
<p>Upgraded to Motor Control Library 0.20</p>
<ul class="simple">
<li><p>Adds support for dsPIC33CK devices</p></li>
<li><p>Back-ported additional functions used in MCAF R4</p></li>
</ul>
</section>
<section id="id20">
<h4><span class="section-number">7.5.2.4.12. </span>Auxiliary reports<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added section “Normalization factors used in fixed-point representation” (DB_MC-2049)</p></li>
</ul>
</section>
</section>
<section id="mcaf-r6-rc8">
<span id="appendix-revhistory-r6rc8"></span><h3><span class="section-number">7.5.2.5. </span>MCAF R6 RC8<a class="headerlink" href="#mcaf-r6-rc8" title="Permalink to this heading">¶</a></h3>
<section id="id21">
<h4><span class="section-number">7.5.2.5.1. </span>Modules added/removed<a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> module (DB_MC-796)</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/flux_control/index.html#algorithm-flux-control"><span class="std std-ref">Flux Control</span></a> module (DB_MC-2853)</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-deadtimecompensation"><span class="std std-ref">Dead-time compensation</span></a> module (DB_MC-1969)</p></li>
</ul>
</section>
<section id="adjustable-pwm-frequency">
<h4><span class="section-number">7.5.2.5.2. </span>Adjustable PWM frequency<a class="headerlink" href="#adjustable-pwm-frequency" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for adjusting PWM frequency and control frequency as a submultiple of the PWM frequency. (DB_MC-2720, DB_MC-2950)
Please refer to <a class="reference internal" href="../implementation/sampling-rate.html#impl-sampling-rate"><span class="std std-ref">Sampling Rate and PWM Frequency Implications</span></a> for more information.</p></li>
</ul>
</section>
<section id="motion-control-api">
<h4><span class="section-number">7.5.2.5.3. </span>Motion Control API<a class="headerlink" href="#motion-control-api" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> to provide a high-level abstracted interface for custom applications to control and obtain feedback from the motor. (DB_MC-796)</p></li>
<li><p>Added a <a class="reference internal" href="../components/main.html#component-main-r6"><span class="std std-ref">sample application</span></a>
that demonstrates the use of <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a> to implement a simple user interface with pushbuttons and the potentiometer.</p></li>
</ul>
</section>
<section id="flux-control">
<h4><span class="section-number">7.5.2.5.4. </span>Flux Control<a class="headerlink" href="#flux-control" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for <a class="reference internal" href="../algorithms/flux_control/flux_weakening.html#algorithm-flux-weakening"><span class="std std-ref">flux weakening</span></a> to extend velocity range. (DB_MC-2723)</p></li>
<li><p>Added support for <a class="reference internal" href="../algorithms/flux_control/mtpa.html#algorithm-mtpa"><span class="std std-ref">maximum torque per ampere</span></a> to improve torque and efficiency for <a class="reference internal" href="glossary.html#term-IPM"><span class="xref std std-term">IPM</span></a> motors. (DB_MC-2724)</p></li>
<li><p>Refactored FOC with structural changes to support flux weakening and MTPA. (DB_MC-2861, DB_MC-2863)
For more information, see <a class="reference internal" href="../components/foc.html#foc-impl-iqlimit"><span class="std std-ref">Velocity loop current limit</span></a> and <a class="reference internal" href="../components/foc.html#foc-impl-sat-antiwindup"><span class="std std-ref">Saturation and anti-windup</span></a>.</p></li>
</ul>
</section>
<section id="dead-time-compensation">
<h4><span class="section-number">7.5.2.5.5. </span>Dead-time compensation<a class="headerlink" href="#dead-time-compensation" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for <a class="reference internal" href="../algorithms/dead-time-comp.html#algorithm-deadtimecompensation"><span class="std std-ref">dead-time compensation</span></a> to mitigate some of the effects of <a class="reference internal" href="../algorithms/dead-time-comp.html#dtc-distortion"><span class="std std-ref">deadtime distortion</span></a>. (DB_MC-1969)</p></li>
</ul>
</section>
<section id="dspic33ck-support">
<h4><span class="section-number">7.5.2.5.6. </span>dsPIC33CK support<a class="headerlink" href="#dspic33ck-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for dsPIC33CK64MP105 and dsPIC33CK64MC105 (DB_MC-2694, DB_MC-2693)</p></li>
</ul>
</section>
<section id="board-service-module">
<h4><span class="section-number">7.5.2.5.7. </span>Board service module<a class="headerlink" href="#board-service-module" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Restructured to improve timing robustness and to interface with the <a class="reference internal" href="../components/mcapi.html#mcapi"><span class="std std-ref">Motion Control API</span></a>.
(DB_MC-2726, DB_MC-2728, DB_MC-2732) See <a class="reference internal" href="../components/hal.html#hal-mcaf-r6"><span class="std std-ref">board service module</span></a> changes for more information.</p></li>
</ul>
</section>
<section id="id22">
<h4><span class="section-number">7.5.2.5.8. </span>Test Harness<a class="headerlink" href="#id22" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added feature to <a class="reference internal" href="../components/testharness.html#test-fluxctrl-override"><span class="std std-ref">override d-axis current computation</span></a>,
preventing flux control module from changing it, and allowing it to be changed via real-time diagnostic tools.
(DB_MC-2855)</p></li>
</ul>
</section>
<section id="id23">
<h4><span class="section-number">7.5.2.5.9. </span>motorBench<sup>®</sup> Development Suite Customize page support<a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added read-only parameter calculations such as Saliency ratio (DB_MC-2903)</p></li>
<li><p>Included additional customizable parameters. (DB_MC-2689, DB_MC-2750, DB_MC-2838, DB_MC-2879, DB_MC-2882, DB_MC-2905)</p></li>
</ul>
</section>
<section id="improvements-in-modularity">
<h4><span class="section-number">7.5.2.5.10. </span>Improvements in modularity<a class="headerlink" href="#improvements-in-modularity" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>All calls to MCC HAL are now made through HAF (DB_MC-2671)</p></li>
<li><p>Removed directly modifying registers to clear status bits (DB_MC-2696)</p></li>
<li><p>Refactored data flow interface for estimators and flux control module to reduce tight coupling (DB_MC-2854)</p></li>
<li><p>Refactored back-emf calculation for use by estimators and flux control module
(DB_MC-2106)</p></li>
</ul>
</section>
<section id="naming-improvements">
<h4><span class="section-number">7.5.2.5.11. </span>Naming improvements<a class="headerlink" href="#naming-improvements" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Improved names for PWM generators (DB_MC-2807)</p></li>
<li><p>Replaced inconsistent PI parameters (DB_MC-2857)</p></li>
<li><p>Removed <code class="docutils literal notranslate"><span class="pre">NORM_</span></code> prefix from ATPLL constants (DB_MC-2712)</p></li>
<li><p>Rename test harness functions to use verb “Trigger” for clarification
(TriggerSeizure, TriggerStackOverflow) (DB_MC-1720)</p></li>
<li><p>Addressed potential naming collision between PLL and ATPLL
(DB_MC-2602)</p></li>
</ul>
</section>
<section id="miscellaneous-firmware-issues">
<h4><span class="section-number">7.5.2.5.12. </span>Miscellaneous firmware issues<a class="headerlink" href="#miscellaneous-firmware-issues" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Improve how velocities are represented in generated code in parameters/* files (DB_MC-2915)</p></li>
<li><p>Removed unnecessary and added missing #include statements in several locations (DB_MC-1719)</p></li>
<li><p>Tracking loop Kp value can now vary between a Q8 - Q15 value (DB_MC-2688)</p></li>
<li><p>Fixed half-PWM-cycle short circuit across motor during entry to STOPPING state (DB_MC-2931)</p></li>
</ul>
</section>
</section>
<section id="mcaf-r7-rc37">
<span id="appendix-revhistory-r7rc37"></span><h3><span class="section-number">7.5.2.6. </span>MCAF R7 RC37<a class="headerlink" href="#mcaf-r7-rc37" title="Permalink to this heading">¶</a></h3>
<section id="id24">
<h4><span class="section-number">7.5.2.6.1. </span>Modules added/removed<a class="headerlink" href="#id24" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">current_measure</span></code> module to support <a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-single-channel"><span class="std std-ref">single-channel</span></a>
and multi-channel current measurement (DB_MC-3350, DB_MC-3623)</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/dynlimit-simple.html#algorithm-dynlim-simple"><span class="std std-ref">dynamic current limit</span></a> module (DB_MC-3283)</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/zsmt.html#algorithm-zsmt"><span class="std std-ref">ZS/MT</span></a> and ZS/MT hybrid estimator modules (DB_MC-3079, DB_MC-3140)</p></li>
</ul>
</section>
<section id="mcc-melody">
<h4><span class="section-number">7.5.2.6.2. </span>MCC Melody<a class="headerlink" href="#mcc-melody" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Updated motorBench/hal/hardware_access_functions.h to add new methods and update existing methods to work with
peripheral drivers from <a class="reference external" href="https://www.microchip.com/en-us/tools-resources/configure/mplab-code-configurator/melody">MCC Melody</a> .</p></li>
<li><p>Updated <a class="reference internal" href="../components/main.html#sample-application"><span class="std std-ref">sample application</span></a> to use <a class="reference external" href="https://www.microchip.com/en-us/tools-resources/configure/mplab-code-configurator/melody">MCC Melody</a> timer interfaces.</p></li>
</ul>
</section>
<section id="dynamic-current-limit">
<h4><span class="section-number">7.5.2.6.3. </span>Dynamic current limit<a class="headerlink" href="#dynamic-current-limit" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for <a class="reference internal" href="../algorithms/dynlimit-simple.html#algorithm-dynlim-simple"><span class="std std-ref">Dynamic current limiting</span></a> to allow short transient
currents above the continuous current limit. (DB_MC-3283)</p></li>
</ul>
</section>
<section id="zsmtlong-zs-mt-estimator">
<h4><span class="section-number">7.5.2.6.4. </span>Zero-Speed / Maximum Torque (ZS/MT) estimator<a class="headerlink" href="#zsmtlong-zs-mt-estimator" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../algorithms/zsmt.html#algorithm-zsmt"><span class="std std-ref">Zero-Speed / Maximum Torque (ZS/MT)</span></a> estimator (DB_MC-3109) with <a class="reference internal" href="../algorithms/startup.html#startup-zsmt-ipc"><span class="std std-ref">initial
position correction startup</span></a> (DB_MC-3166)</p></li>
<li><p>Refactored startup interface to accommodate the requirements of ZS/MT initial position correction
startup method.</p></li>
<li><p>Refactored FOC <a class="reference internal" href="glossary.html#term-forward-path"><span class="xref std std-term">forward path</span></a> and commutation module with structural changes to
support <a class="reference internal" href="../algorithms/estimator-interface.html#algorithm-estimator-terminology"><span class="std std-ref">intrusive estimators</span></a></p></li>
</ul>
</section>
<section id="binary-hard-switching-hybrid-estimator">
<h4><span class="section-number">7.5.2.6.5. </span>Binary hard switching hybrid estimator<a class="headerlink" href="#binary-hard-switching-hybrid-estimator" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added Binary hard switching hybrid estimator (DB_MC-3140)</p></li>
<li><p>Added new interfaces to the <code class="docutils literal notranslate"><span class="pre">pll</span></code> module of <a class="reference internal" href="../algorithms/pll.html#algorithm-pll"><span class="std std-ref">AN1292 PLL estimator</span></a> that enables
it to interact with the hybrid estimator.</p></li>
</ul>
</section>
<section id="closed-loop-stopping-methods">
<h4><span class="section-number">7.5.2.6.6. </span>Closed loop stopping methods<a class="headerlink" href="#closed-loop-stopping-methods" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../algorithms/stopping.html#algorithm-stopping-closed-loop"><span class="std std-ref">closed-loop stopping</span></a> methods to restart motion quickly
with certain types of estimators (DB_MC-3440)</p></li>
</ul>
</section>
<section id="voltage-control-outer-loop">
<h4><span class="section-number">7.5.2.6.7. </span>Voltage control outer loop<a class="headerlink" href="#voltage-control-outer-loop" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Updated the FOC module to support outer <a class="reference internal" href="../algorithms/voltage-control.html#algorithm-voltagecontrol"><span class="std std-ref">voltage loop</span></a> in addition to the
existing outer velocity loop (DB_MC-3338)</p></li>
</ul>
</section>
<section id="mcapi">
<h4><span class="section-number">7.5.2.6.8. </span>MCAPI<a class="headerlink" href="#mcapi" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added methods to get and set the application fault code.</p></li>
<li><p>Function calls to user-defined ADC <a class="reference internal" href="glossary.html#term-ISR"><span class="xref std std-term">ISR</span></a> functions can now be enabled or disabled in the Customize page of motorBench<sup>®</sup> Development Suite (DB_MC-3045)</p></li>
</ul>
</section>
<section id="main-application">
<h4><span class="section-number">7.5.2.6.9. </span>Main application<a class="headerlink" href="#main-application" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Restructured <code class="docutils literal notranslate"><span class="pre">sample_mcaf_application</span></code> module (DB_MC-3281, DB_MC-3744, DB_MC-3292) to separate MCAF related
code from the <a class="reference internal" href="../components/main.html#sample-application"><span class="std std-ref">sample application</span></a>. See <a class="reference internal" href="../components/main.html#component-main-r7"><span class="std std-ref">Main Application</span></a> for more details.</p></li>
</ul>
</section>
<section id="single-and-multi-channel-current-measurement">
<h4><span class="section-number">7.5.2.6.10. </span>Single and multi-channel current measurement<a class="headerlink" href="#single-and-multi-channel-current-measurement" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for <a class="reference internal" href="../algorithms/foc/current_measure.html#algorithm-current-single-channel"><span class="std std-ref">Single-channel</span></a> current measurement (“single-shunt”)</p></li>
<li><p>Upgrades to the <code class="docutils literal notranslate"><span class="pre">adc_compensation</span></code> component to support one/two/three channel current measurement
schemes (DB_MC-3350)</p></li>
<li><p>Updated FOC <a class="reference internal" href="../algorithms/foc/fundamentals.html#foc-blkdiag"><span class="std std-ref">feedback path</span></a> to optionally use a <a class="reference internal" href="../algorithms/foc/fundamentals.html#foc-alt-ref-frame-transforms"><span class="std std-ref">three-input Clarke transform</span></a> to support three-channel current measurement.</p></li>
</ul>
</section>
<section id="internal-op-amp-support">
<h4><span class="section-number">7.5.2.6.11. </span>Internal op amp support<a class="headerlink" href="#internal-op-amp-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for internal op amps on dsPIC<sup>®</sup> DSC devices for motor phase current measurement</p></li>
</ul>
</section>
<section id="development-board-support">
<h4><span class="section-number">7.5.2.6.12. </span>Development board support<a class="headerlink" href="#development-board-support" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added support for <a class="reference external" href="https://www.microchip.com/en-us/development-tool/DM330031">dsPIC33CK Low Voltage Motor Control (LVMC) Development Board</a></p></li>
<li><p>Added support for <a class="reference external" href="https://www.microchip.com/en-us/development-tool/EV18H47A">MCS MCLV‑48V‑300W Development Board</a></p></li>
</ul>
</section>
<section id="id25">
<h4><span class="section-number">7.5.2.6.13. </span>Test harness<a class="headerlink" href="#id25" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added <a class="reference internal" href="../components/testharness.html#test-triggered-average"><span class="std std-ref">triggered average</span></a> calculation (DB_MC-3619)</p></li>
<li><p>Added <a class="reference internal" href="../components/testharness.html#test-perturbation-asymmetric"><span class="std std-ref">Asymmetric perturbation</span></a> (DB_MC-3373)</p></li>
<li><p>Added override for <a class="reference internal" href="../components/testharness.html#test-zsm-override"><span class="std std-ref">zero-sequence modulation</span></a> (DB_MC-3316)</p></li>
</ul>
</section>
<section id="id26">
<h4><span class="section-number">7.5.2.6.14. </span>motorBench<sup>®</sup> Development Suite Customize page support<a class="headerlink" href="#id26" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Added new customizable parameters (DB_MC-3687)</p></li>
<li><p>Decoupled customization parameter for motor <a class="reference internal" href="../implementation/ui-customization.html#customize-operation-startup-velocity-ratio"><span class="std std-ref">startup speed</span></a> from <a class="reference internal" href="../implementation/ui-customization.html#customize-operation-min-velocity-ratio"><span class="std std-ref">minimum speed command</span></a> (DB_MC-2960)</p></li>
<li><p>Made minor improvements in overall Customize page user interface behavior (DB_MC-4030, DB_MC-4013, DB_MC-3739)</p></li>
</ul>
</section>
<section id="miscellaneous-firmware-improvements-and-issues">
<h4><span class="section-number">7.5.2.6.15. </span>Miscellaneous firmware improvements and issues<a class="headerlink" href="#miscellaneous-firmware-improvements-and-issues" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Updated <a class="reference internal" href="../algorithms/pll.html#algorithm-pll"><span class="std std-ref">AN1292 PLL estimator</span></a> <code class="docutils literal notranslate"><span class="pre">pll</span></code> module to allow runtime adjustment of the tuning
parameter for Ke using a real time debug tool such as
<a class="reference external" href="https://gallery.microchip.com/packages/x2c-scope/">X2C-Scope</a> (DB_MC-3740)</p></li>
<li><p>Compensated for time delays in voltage input of sensorless estimators (DB_MC-3415)</p></li>
<li><p>Added <a class="reference internal" href="../implementation/ui-customization.html#customize-overmodulation-include-duty-clipping"><span class="std std-ref">Customize parameter</span></a> to select the voltage feedback
for sensorless estimators from zero sequence shifted voltage or unshifted voltage from the
FOC <a class="reference internal" href="glossary.html#term-forward-path"><span class="xref std std-term">forward path</span></a> (DB_MC-3318)</p></li>
<li><p>Updated DC link voltage scaling to allow a different gain compared to ADC full-scale (DB_MC-3267)</p></li>
<li><p>Updated <a class="reference internal" href="../components/supervisory.html#supervisory-stall-detect"><span class="std std-ref">stall detect</span></a> to detect motor stall condition only after the
motor startup is complete (DB_MC-3244)</p></li>
<li><p>Fixed an issue with <a class="reference internal" href="../components/hal.html#board-service-module-bootstrap-charging"><span class="std std-ref">PWM bootstrap charging routine</span></a> and
<a class="reference internal" href="../components/adc.html#component-adc-calibration"><span class="std std-ref">ADC offset compensation routine</span></a> executing concurrently in the
<code class="docutils literal notranslate"><span class="pre">MCSM_RESTART</span></code> state (DB_MC-3134)</p></li>
<li><p>Added <a class="reference internal" href="../algorithms/temperature-measure.html#algorithm-temperature"><span class="std std-ref">Inverter bridge temperature measurement</span></a> and
<a class="reference internal" href="../components/supervisory.html#supervisory-overtemperature"><span class="std std-ref">overtemperature fault</span></a> (DB_MC-3282)</p></li>
<li><p>Removed the use of direction flag in the UI module from <code class="docutils literal notranslate"><span class="pre">foc</span></code>, <code class="docutils literal notranslate"><span class="pre">commutation</span></code> and <code class="docutils literal notranslate"><span class="pre">mcapi</span></code>
modules (DB_MC-2926)</p></li>
<li><p>Added new instruction cycle optimized right shift functions in <code class="docutils literal notranslate"><span class="pre">util</span></code> module (DB_MC-4115)</p></li>
<li><p>Added new functions to the <code class="docutils literal notranslate"><span class="pre">util</span></code> module in support of updates to other modules
in MCAF (DB_MC-3749, DB_MC-3750, DB_MC-3751, DB_MC-3752)</p></li>
<li><p>Consolidated low-pass filter implementation variants into one canonical low-pass filter
implementation in filter.h  (DB_MC-3590)</p></li>
<li><p>Fixed an issue with motor startup state machine that caused it to lose synchronization
with MCAF state machine at initialization (DB_MC-3332)</p></li>
<li><p>Updated <a class="reference internal" href="../components/hal.html#board-service-module-bootstrap-charging"><span class="std std-ref">PWM bootstrap charging routine</span></a> to use a fixed value
of minimum pulse width on PWMxL channels rather than a ramp of PWMxL duty cycle from zero (DB_MC-978)</p></li>
<li><p>Updated <a class="reference internal" href="../components/hal.html#board-service-module"><span class="std std-ref">board service module</span></a> to eliminate all instances of global variable
access of <code class="docutils literal notranslate"><span class="pre">MCAF_BOARD_DATA</span> <span class="pre">board</span></code> (DB_MC-3044)</p></li>
</ul>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">7.5. Revision History</a><ul>
<li><a class="reference internal" href="#mcaf-documentation-revision-history">7.5.1. MCAF Documentation Revision History</a></li>
<li><a class="reference internal" href="#mcaf-revision-history">7.5.2. MCAF Revision History</a><ul>
<li><a class="reference internal" href="#mcaf-r2-rc9">7.5.2.1. MCAF R2 RC9</a><ul>
<li><a class="reference internal" href="#modules-added-removed">7.5.2.1.1. Modules added/removed</a></li>
<li><a class="reference internal" href="#core-foc">7.5.2.1.2. Core FOC</a></li>
<li><a class="reference internal" href="#overmodulation">7.5.2.1.3. Overmodulation</a></li>
<li><a class="reference internal" href="#dc-link-compensation">7.5.2.1.4. DC link compensation</a></li>
<li><a class="reference internal" href="#expanded-range-of-supported-motors">7.5.2.1.5. Expanded range of supported motors</a></li>
<li><a class="reference internal" href="#scaling-factors-and-operating-range">7.5.2.1.6. Scaling factors and operating range</a></li>
<li><a class="reference internal" href="#fault-detection">7.5.2.1.7. Fault detection</a></li>
<li><a class="reference internal" href="#test-harness">7.5.2.1.8. Test Harness</a></li>
<li><a class="reference internal" href="#hal">7.5.2.1.9. HAL</a></li>
<li><a class="reference internal" href="#motor-control-library">7.5.2.1.10. Motor Control Library</a></li>
<li><a class="reference internal" href="#miscellaneous">7.5.2.1.11. Miscellaneous</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mcaf-r3-rc14">7.5.2.2. MCAF R3 RC14</a><ul>
<li><a class="reference internal" href="#id1">7.5.2.2.1. Modules added/removed</a></li>
<li><a class="reference internal" href="#mcc-compatibility">7.5.2.2.2. MCC compatibility</a></li>
<li><a class="reference internal" href="#mchv-2-and-mchv-3-compatibility">7.5.2.2.3. MCHV-2 and MCHV-3 compatibility</a></li>
<li><a class="reference internal" href="#id2">7.5.2.2.4. Scaling factors and operating range</a></li>
<li><a class="reference internal" href="#adc-compensation">7.5.2.2.5. ADC compensation</a></li>
<li><a class="reference internal" href="#id3">7.5.2.2.6. Core FOC</a></li>
<li><a class="reference internal" href="#id4">7.5.2.2.7. Fault detection</a></li>
<li><a class="reference internal" href="#id5">7.5.2.2.8. Test Harness</a></li>
<li><a class="reference internal" href="#id6">7.5.2.2.9. HAL</a></li>
<li><a class="reference internal" href="#id7">7.5.2.2.10. Motor Control Library</a></li>
<li><a class="reference internal" href="#code-generation">7.5.2.2.11. Code generation</a></li>
<li><a class="reference internal" href="#auxiliary-reports">7.5.2.2.12. Auxiliary reports</a></li>
<li><a class="reference internal" href="#id8">7.5.2.2.13. Miscellaneous</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mcaf-r4-rc12">7.5.2.3. MCAF R4 RC12</a><ul>
<li><a class="reference internal" href="#id9">7.5.2.3.1. Modules added/removed</a></li>
<li><a class="reference internal" href="#revhistory-r4-mcc">7.5.2.3.2. MCC compatibility</a></li>
<li><a class="reference internal" href="#quadrature-encoder-support">7.5.2.3.3. Quadrature encoder support</a></li>
<li><a class="reference internal" href="#parameter-customization-support">7.5.2.3.4. Parameter customization support</a></li>
<li><a class="reference internal" href="#startup">7.5.2.3.5. Startup</a></li>
<li><a class="reference internal" href="#id11">7.5.2.3.6. Core FOC</a></li>
<li><a class="reference internal" href="#id12">7.5.2.3.7. Code generation</a></li>
<li><a class="reference internal" href="#id13">7.5.2.3.8. Test Harness</a></li>
<li><a class="reference internal" href="#style-and-readability">7.5.2.3.9. Style and readability</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mcaf-r5-rc11">7.5.2.4. MCAF R5 RC11</a><ul>
<li><a class="reference internal" href="#id14">7.5.2.4.1. Modules added/removed</a></li>
<li><a class="reference internal" href="#mcc-compatibility-and-dspic33ck-support">7.5.2.4.2. MCC compatibility and dsPIC33CK support</a></li>
<li><a class="reference internal" href="#id15">7.5.2.4.3. HAL</a></li>
<li><a class="reference internal" href="#diagnostics">7.5.2.4.4. Diagnostics</a></li>
<li><a class="reference internal" href="#id16">7.5.2.4.5. Quadrature encoder support</a></li>
<li><a class="reference internal" href="#atpll-support">7.5.2.4.6. ATPLL support</a></li>
<li><a class="reference internal" href="#miscellaneous-sensorless-estimator-issues">7.5.2.4.7. Miscellaneous sensorless estimator issues</a></li>
<li><a class="reference internal" href="#id17">7.5.2.4.8. Startup</a></li>
<li><a class="reference internal" href="#id18">7.5.2.4.9. Test Harness</a></li>
<li><a class="reference internal" href="#mb-customize-page-support">7.5.2.4.10. motorBench<sup>®</sup> Development Suite Customize page support</a></li>
<li><a class="reference internal" href="#id19">7.5.2.4.11. Motor Control Library</a></li>
<li><a class="reference internal" href="#id20">7.5.2.4.12. Auxiliary reports</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mcaf-r6-rc8">7.5.2.5. MCAF R6 RC8</a><ul>
<li><a class="reference internal" href="#id21">7.5.2.5.1. Modules added/removed</a></li>
<li><a class="reference internal" href="#adjustable-pwm-frequency">7.5.2.5.2. Adjustable PWM frequency</a></li>
<li><a class="reference internal" href="#motion-control-api">7.5.2.5.3. Motion Control API</a></li>
<li><a class="reference internal" href="#flux-control">7.5.2.5.4. Flux Control</a></li>
<li><a class="reference internal" href="#dead-time-compensation">7.5.2.5.5. Dead-time compensation</a></li>
<li><a class="reference internal" href="#dspic33ck-support">7.5.2.5.6. dsPIC33CK support</a></li>
<li><a class="reference internal" href="#board-service-module">7.5.2.5.7. Board service module</a></li>
<li><a class="reference internal" href="#id22">7.5.2.5.8. Test Harness</a></li>
<li><a class="reference internal" href="#id23">7.5.2.5.9. motorBench<sup>®</sup> Development Suite Customize page support</a></li>
<li><a class="reference internal" href="#improvements-in-modularity">7.5.2.5.10. Improvements in modularity</a></li>
<li><a class="reference internal" href="#naming-improvements">7.5.2.5.11. Naming improvements</a></li>
<li><a class="reference internal" href="#miscellaneous-firmware-issues">7.5.2.5.12. Miscellaneous firmware issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mcaf-r7-rc37">7.5.2.6. MCAF R7 RC37</a><ul>
<li><a class="reference internal" href="#id24">7.5.2.6.1. Modules added/removed</a></li>
<li><a class="reference internal" href="#mcc-melody">7.5.2.6.2. MCC Melody</a></li>
<li><a class="reference internal" href="#dynamic-current-limit">7.5.2.6.3. Dynamic current limit</a></li>
<li><a class="reference internal" href="#zsmtlong-zs-mt-estimator">7.5.2.6.4. Zero-Speed / Maximum Torque (ZS/MT) estimator</a></li>
<li><a class="reference internal" href="#binary-hard-switching-hybrid-estimator">7.5.2.6.5. Binary hard switching hybrid estimator</a></li>
<li><a class="reference internal" href="#closed-loop-stopping-methods">7.5.2.6.6. Closed loop stopping methods</a></li>
<li><a class="reference internal" href="#voltage-control-outer-loop">7.5.2.6.7. Voltage control outer loop</a></li>
<li><a class="reference internal" href="#mcapi">7.5.2.6.8. MCAPI</a></li>
<li><a class="reference internal" href="#main-application">7.5.2.6.9. Main application</a></li>
<li><a class="reference internal" href="#single-and-multi-channel-current-measurement">7.5.2.6.10. Single and multi-channel current measurement</a></li>
<li><a class="reference internal" href="#internal-op-amp-support">7.5.2.6.11. Internal op amp support</a></li>
<li><a class="reference internal" href="#development-board-support">7.5.2.6.12. Development board support</a></li>
<li><a class="reference internal" href="#id25">7.5.2.6.13. Test harness</a></li>
<li><a class="reference internal" href="#id26">7.5.2.6.14. motorBench<sup>®</sup> Development Suite Customize page support</a></li>
<li><a class="reference internal" href="#miscellaneous-firmware-improvements-and-issues">7.5.2.6.15. Miscellaneous firmware improvements and issues</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="otherdocs.html"
                          title="previous chapter"><span class="section-number">7.4. </span>Related Documents</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../faq.html"
                          title="next chapter"><span class="section-number">8. </span>Frequently Asked Questions (FAQ)</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../faq.html" title="8. Frequently Asked Questions (FAQ)"
             >next</a> |</li>
        <li class="right" >
          <a href="otherdocs.html" title="7.4. Related Documents"
             >previous</a> |</li>
    <li><img class="nav-logo"
             src="../_static/Microchip-Logo-Horizontal-White-Red-120x28.png" alt=""
        /></li>
    <li><a href=""></a> &#187;</li>
    <a href="../index.html">MCAF R7 RC37 (docver 7.0.2)</a> &#187;
    
          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">7. </span>Appendix</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">7.5. </span>Revision History</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2023, Microchip Technology, Inc..
    </div>
  </body>
</html>